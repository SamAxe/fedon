/* wiki-client - 0.31.0-decaffeinate.5 - Mon, 18 Nov 2024 03:31:27 GMT */
"use strict";(()=>{var qs=Object.create;var Tt=Object.defineProperty;var zs=Object.getOwnPropertyDescriptor;var Us=Object.getOwnPropertyNames;var Bs=Object.getPrototypeOf,Ws=Object.prototype.hasOwnProperty;var lt=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var oe=(t,e)=>()=>(t&&(e=t(t=0)),e);var J=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),le=(t,e)=>{for(var n in e)Tt(t,n,{get:e[n],enumerable:!0})},Pr=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Us(e))!Ws.call(t,o)&&o!==n&&Tt(t,o,{get:()=>e[o],enumerable:!(r=zs(e,o))||r.enumerable});return t};var ie=(t,e,n)=>(n=t!=null?qs(Bs(t)):{},Pr(e||!t||!t.__esModule?Tt(n,"default",{value:t,enumerable:!0}):n,t)),q=t=>Pr(Tt({},"__esModule",{value:!0}),t);var Dr=J((Rt,Lr)=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.default=Ks;function Ks(t){return function(...e){if(t===null)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,e)}}Lr.exports=Rt.default});var mn=J(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.fallback=Or;Le.wrap=Mr;var Vs=Le.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,Js=Le.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ys=Le.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function Or(t){setTimeout(t,0)}function Mr(t){return(e,...n)=>t(()=>e(...n))}var ut;Vs?ut=queueMicrotask:Js?ut=setImmediate:Ys?ut=process.nextTick:ut=Or;Le.default=Mr(ut)});var Nr=J((At,jr)=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});var yn=class{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,n){n.prev=e,n.next=e.next,e.next?e.next.prev=n:this.tail=n,e.next=n,this.length+=1}insertBefore(e,n){n.prev=e.prev,n.next=e,e.prev?e.prev.next=n:this.head=n,e.prev=n,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):Fr(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):Fr(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var n=this.head;n;){var{next:r}=n;e(n)&&this.removeLink(n),n=r}return this}};At.default=yn;function Fr(t,e){t.length=1,t.head=t.tail=e}jr.exports=At.default});var zr=J((Pt,qr)=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.default=function(t){return function(...e){var n=e.pop();return t.call(this,e,n)}};qr.exports=Pt.default});var Vr=J((Lt,Kr)=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.default=ea;var Hs=zr(),Gs=Wr(Hs),Qs=mn(),Xs=Wr(Qs),Zs=Dt();function Wr(t){return t&&t.__esModule?t:{default:t}}function ea(t){return(0,Zs.isAsync)(t)?function(...e){let n=e.pop(),r=t.apply(this,e);return Ur(r,n)}:(0,Gs.default)(function(e,n){var r;try{r=t.apply(this,e)}catch(o){return n(o)}if(r&&typeof r.then=="function")return Ur(r,n);n(null,r)})}function Ur(t,e){return t.then(n=>{Br(e,null,n)},n=>{Br(e,n&&(n instanceof Error||n.message)?n:new Error(n))})}function Br(t,e,n){try{t(e,n)}catch(r){(0,Xs.default)(o=>{throw o},r)}}Kr.exports=Lt.default});var Dt=J(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.isAsyncIterable=ke.isAsyncGenerator=ke.isAsync=void 0;var ta=Vr(),na=ra(ta);function ra(t){return t&&t.__esModule?t:{default:t}}function Jr(t){return t[Symbol.toStringTag]==="AsyncFunction"}function oa(t){return t[Symbol.toStringTag]==="AsyncGenerator"}function ia(t){return typeof t[Symbol.asyncIterator]=="function"}function sa(t){if(typeof t!="function")throw new Error("expected a function");return Jr(t)?(0,na.default)(t):t}ke.default=sa;ke.isAsync=Jr;ke.isAsyncGenerator=oa;ke.isAsyncIterable=ia});var Hr=J((Mt,Yr)=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.default=pa;var aa=Dr(),ca=Ot(aa),la=mn(),vn=Ot(la),ua=Nr(),fa=Ot(ua),da=Dt(),ha=Ot(da);function Ot(t){return t&&t.__esModule?t:{default:t}}function pa(t,e,n){if(e==null)e=1;else if(e===0)throw new RangeError("Concurrency must not be zero");var r=(0,ha.default)(t),o=0,i=[];let c={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function d(T,P){c[T].push(P)}function u(T,P){let j=(...W)=>{s(T,j),P(...W)};c[T].push(j)}function s(T,P){if(!T)return Object.keys(c).forEach(j=>c[j]=[]);if(!P)return c[T]=[];c[T]=c[T].filter(j=>j!==P)}function f(T,...P){c[T].forEach(j=>j(...P))}var m=!1;function h(T,P,j,W){if(W!=null&&typeof W!="function")throw new Error("task callback must be a function");R.started=!0;var S,O;function M(G,...Q){if(G)return j?O(G):S();if(Q.length<=1)return S(Q[0]);S(Q)}var B=R._createTaskItem(T,j?M:W||M);if(P?R._tasks.unshift(B):R._tasks.push(B),m||(m=!0,(0,vn.default)(()=>{m=!1,R.process()})),j||!W)return new Promise((G,Q)=>{S=G,O=Q})}function g(T){return function(P,...j){o-=1;for(var W=0,S=T.length;W<S;W++){var O=T[W],M=i.indexOf(O);M===0?i.shift():M>0&&i.splice(M,1),O.callback(P,...j),P!=null&&f("error",P,O.data)}o<=R.concurrency-R.buffer&&f("unsaturated"),R.idle()&&f("drain"),R.process()}}function x(T){return T.length===0&&R.idle()?((0,vn.default)(()=>f("drain")),!0):!1}let C=T=>P=>{if(!P)return new Promise((j,W)=>{u(T,(S,O)=>{if(S)return W(S);j(O)})});s(T),d(T,P)};var D=!1,R={_tasks:new fa.default,_createTaskItem(T,P){return{data:T,callback:P}},*[Symbol.iterator](){yield*R._tasks[Symbol.iterator]()},concurrency:e,payload:n,buffer:e/4,started:!1,paused:!1,push(T,P){return Array.isArray(T)?x(T)?void 0:T.map(j=>h(j,!1,!1,P)):h(T,!1,!1,P)},pushAsync(T,P){return Array.isArray(T)?x(T)?void 0:T.map(j=>h(j,!1,!0,P)):h(T,!1,!0,P)},kill(){s(),R._tasks.empty()},unshift(T,P){return Array.isArray(T)?x(T)?void 0:T.map(j=>h(j,!0,!1,P)):h(T,!0,!1,P)},unshiftAsync(T,P){return Array.isArray(T)?x(T)?void 0:T.map(j=>h(j,!0,!0,P)):h(T,!0,!0,P)},remove(T){R._tasks.remove(T)},process(){if(!D){for(D=!0;!R.paused&&o<R.concurrency&&R._tasks.length;){var T=[],P=[],j=R._tasks.length;R.payload&&(j=Math.min(j,R.payload));for(var W=0;W<j;W++){var S=R._tasks.shift();T.push(S),i.push(S),P.push(S.data)}o+=1,R._tasks.length===0&&f("empty"),o===R.concurrency&&f("saturated");var O=(0,ca.default)(g(T));r(P,O)}D=!1}},length(){return R._tasks.length},running(){return o},workersList(){return i},idle(){return R._tasks.length+o===0},pause(){R.paused=!0},resume(){R.paused!==!1&&(R.paused=!1,(0,vn.default)(R.process))}};return Object.defineProperties(R,{saturated:{writable:!1,value:C("saturated")},unsaturated:{writable:!1,value:C("unsaturated")},empty:{writable:!1,value:C("empty")},drain:{writable:!1,value:C("drain")},error:{writable:!1,value:C("error")}}),R}Yr.exports=Mt.default});var Xr=J((Ft,Qr)=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.default=function(t,e){var n=(0,va.default)(t);return(0,ma.default)((r,o)=>{n(r[0],o)},e,1)};var ga=Hr(),ma=Gr(ga),ya=Dt(),va=Gr(ya);function Gr(t){return t&&t.__esModule?t:{default:t}}Qr.exports=Ft.default});var eo=J((Zr,wn)=>{(function(t){if(typeof Zr=="object"&&typeof wn<"u")wn.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=t()}})(function(){var t,e,n;return function r(o,i,c){function d(f,m){if(!i[f]){if(!o[f]){var h=typeof lt=="function"&&lt;if(!m&&h)return h(f,!0);if(u)return u(f,!0);var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var x=i[f]={exports:{}};o[f][0].call(x.exports,function(C){var D=o[f][1][C];return d(D||C)},x,x.exports,r,o,i,c)}return i[f].exports}for(var u=typeof lt=="function"&&lt,s=0;s<c.length;s++)d(c[s]);return d}({1:[function(r,o,i){(function(c){"use strict";var d=c.MutationObserver||c.WebKitMutationObserver,u;if(d){var s=0,f=new d(C),m=c.document.createTextNode("");f.observe(m,{characterData:!0}),u=function(){m.data=s=++s%2}}else if(!c.setImmediate&&typeof c.MessageChannel<"u"){var h=new c.MessageChannel;h.port1.onmessage=C,u=function(){h.port2.postMessage(0)}}else"document"in c&&"onreadystatechange"in c.document.createElement("script")?u=function(){var R=c.document.createElement("script");R.onreadystatechange=function(){C(),R.onreadystatechange=null,R.parentNode.removeChild(R),R=null},c.document.documentElement.appendChild(R)}:u=function(){setTimeout(C,0)};var g,x=[];function C(){g=!0;for(var R,T,P=x.length;P;){for(T=x,x=[],R=-1;++R<P;)T[R]();P=x.length}g=!1}o.exports=D;function D(R){x.push(R)===1&&!g&&u()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(r,o,i){"use strict";var c=r(1);function d(){}var u={},s=["REJECTED"],f=["FULFILLED"],m=["PENDING"];o.exports=h;function h(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,S!==d&&D(this,S)}h.prototype.catch=function(S){return this.then(null,S)},h.prototype.then=function(S,O){if(typeof S!="function"&&this.state===f||typeof O!="function"&&this.state===s)return this;var M=new this.constructor(d);if(this.state!==m){var B=this.state===f?S:O;x(M,B,this.outcome)}else this.queue.push(new g(M,S,O));return M};function g(S,O,M){this.promise=S,typeof O=="function"&&(this.onFulfilled=O,this.callFulfilled=this.otherCallFulfilled),typeof M=="function"&&(this.onRejected=M,this.callRejected=this.otherCallRejected)}g.prototype.callFulfilled=function(S){u.resolve(this.promise,S)},g.prototype.otherCallFulfilled=function(S){x(this.promise,this.onFulfilled,S)},g.prototype.callRejected=function(S){u.reject(this.promise,S)},g.prototype.otherCallRejected=function(S){x(this.promise,this.onRejected,S)};function x(S,O,M){c(function(){var B;try{B=O(M)}catch(G){return u.reject(S,G)}B===S?u.reject(S,new TypeError("Cannot resolve promise with itself")):u.resolve(S,B)})}u.resolve=function(S,O){var M=R(C,O);if(M.status==="error")return u.reject(S,M.value);var B=M.value;if(B)D(S,B);else{S.state=f,S.outcome=O;for(var G=-1,Q=S.queue.length;++G<Q;)S.queue[G].callFulfilled(O)}return S},u.reject=function(S,O){S.state=s,S.outcome=O;for(var M=-1,B=S.queue.length;++M<B;)S.queue[M].callRejected(O);return S};function C(S){var O=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof O=="function")return function(){O.apply(S,arguments)}}function D(S,O){var M=!1;function B(he){M||(M=!0,u.reject(S,he))}function G(he){M||(M=!0,u.resolve(S,he))}function Q(){O(G,B)}var de=R(Q);de.status==="error"&&B(de.value)}function R(S,O){var M={};try{M.value=S(O),M.status="success"}catch(B){M.status="error",M.value=B}return M}h.resolve=T;function T(S){return S instanceof this?S:u.resolve(new this(d),S)}h.reject=P;function P(S){var O=new this(d);return u.reject(O,S)}h.all=j;function j(S){var O=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=S.length,B=!1;if(!M)return this.resolve([]);for(var G=new Array(M),Q=0,de=-1,he=new this(d);++de<M;)be(S[de],de);return he;function be(L,F){O.resolve(L).then(X,function(Y){B||(B=!0,u.reject(he,Y))});function X(Y){G[F]=Y,++Q===M&&!B&&(B=!0,u.resolve(he,G))}}}h.race=W;function W(S){var O=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=S.length,B=!1;if(!M)return this.resolve([]);for(var G=-1,Q=new this(d);++G<M;)de(S[G]);return Q;function de(he){O.resolve(he).then(function(be){B||(B=!0,u.resolve(Q,be))},function(be){B||(B=!0,u.reject(Q,be))})}}},{1:1}],3:[function(r,o,i){(function(c){"use strict";typeof c.Promise!="function"&&(c.Promise=r(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(r,o,i){"use strict";var c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function d(a,p){if(!(a instanceof p))throw new TypeError("Cannot call a class as a function")}function u(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var s=u();function f(){try{if(!s||!s.open)return!1;var a=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),p=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!a||p)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function m(a,p){a=a||[],p=p||{};try{return new Blob(a,p)}catch(y){if(y.name!=="TypeError")throw y;for(var l=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,v=new l,w=0;w<a.length;w+=1)v.append(a[w]);return v.getBlob(p.type)}}typeof Promise>"u"&&r(3);var h=Promise;function g(a,p){p&&a.then(function(l){p(null,l)},function(l){p(l)})}function x(a,p,l){typeof p=="function"&&a.then(p),typeof l=="function"&&a.catch(l)}function C(a){return typeof a!="string"&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function D(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var R="local-forage-detect-blob-support",T=void 0,P={},j=Object.prototype.toString,W="readonly",S="readwrite";function O(a){for(var p=a.length,l=new ArrayBuffer(p),v=new Uint8Array(l),w=0;w<p;w++)v[w]=a.charCodeAt(w);return l}function M(a){return new h(function(p){var l=a.transaction(R,S),v=m([""]);l.objectStore(R).put(v,"key"),l.onabort=function(w){w.preventDefault(),w.stopPropagation(),p(!1)},l.oncomplete=function(){var w=navigator.userAgent.match(/Chrome\/(\d+)/),y=navigator.userAgent.match(/Edge\//);p(y||!w||parseInt(w[1],10)>=43)}}).catch(function(){return!1})}function B(a){return typeof T=="boolean"?h.resolve(T):M(a).then(function(p){return T=p,T})}function G(a){var p=P[a.name],l={};l.promise=new h(function(v,w){l.resolve=v,l.reject=w}),p.deferredOperations.push(l),p.dbReady?p.dbReady=p.dbReady.then(function(){return l.promise}):p.dbReady=l.promise}function Q(a){var p=P[a.name],l=p.deferredOperations.pop();if(l)return l.resolve(),l.promise}function de(a,p){var l=P[a.name],v=l.deferredOperations.pop();if(v)return v.reject(p),v.promise}function he(a,p){return new h(function(l,v){if(P[a.name]=P[a.name]||$e(),a.db)if(p)G(a),a.db.close();else return l(a.db);var w=[a.name];p&&w.push(a.version);var y=s.open.apply(s,w);p&&(y.onupgradeneeded=function(b){var _=y.result;try{_.createObjectStore(a.storeName),b.oldVersion<=1&&_.createObjectStore(R)}catch(k){if(k.name==="ConstraintError")console.warn('The database "'+a.name+'" has been upgraded from version '+b.oldVersion+" to version "+b.newVersion+', but the storage "'+a.storeName+'" already exists.');else throw k}}),y.onerror=function(b){b.preventDefault(),v(y.error)},y.onsuccess=function(){var b=y.result;b.onversionchange=function(_){_.target.close()},l(b),Q(a)}})}function be(a){return he(a,!1)}function L(a){return he(a,!0)}function F(a,p){if(!a.db)return!0;var l=!a.db.objectStoreNames.contains(a.storeName),v=a.version<a.db.version,w=a.version>a.db.version;if(v&&(a.version!==p&&console.warn('The database "'+a.name+`" can't be downgraded from version `+a.db.version+" to version "+a.version+"."),a.version=a.db.version),w||l){if(l){var y=a.db.version+1;y>a.version&&(a.version=y)}return!0}return!1}function X(a){return new h(function(p,l){var v=new FileReader;v.onerror=l,v.onloadend=function(w){var y=btoa(w.target.result||"");p({__local_forage_encoded_blob:!0,data:y,type:a.type})},v.readAsBinaryString(a)})}function Y(a){var p=O(atob(a.data));return m([p],{type:a.type})}function re(a){return a&&a.__local_forage_encoded_blob}function xe(a){var p=this,l=p._initReady().then(function(){var v=P[p._dbInfo.name];if(v&&v.dbReady)return v.dbReady});return x(l,a,a),l}function Xe(a){G(a);for(var p=P[a.name],l=p.forages,v=0;v<l.length;v++){var w=l[v];w._dbInfo.db&&(w._dbInfo.db.close(),w._dbInfo.db=null)}return a.db=null,be(a).then(function(y){return a.db=y,F(a)?L(a):y}).then(function(y){a.db=p.db=y;for(var b=0;b<l.length;b++)l[b]._dbInfo.db=y}).catch(function(y){throw de(a,y),y})}function ce(a,p,l,v){v===void 0&&(v=1);try{var w=a.db.transaction(a.storeName,p);l(null,w)}catch(y){if(v>0&&(!a.db||y.name==="InvalidStateError"||y.name==="NotFoundError"))return h.resolve().then(function(){if(!a.db||y.name==="NotFoundError"&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),L(a)}).then(function(){return Xe(a).then(function(){ce(a,p,l,v-1)})}).catch(l);l(y)}}function $e(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Bi(a){var p=this,l={db:null};if(a)for(var v in a)l[v]=a[v];var w=P[l.name];w||(w=$e(),P[l.name]=w),w.forages.push(p),p._initReady||(p._initReady=p.ready,p.ready=xe);var y=[];function b(){return h.resolve()}for(var _=0;_<w.forages.length;_++){var k=w.forages[_];k!==p&&y.push(k._initReady().catch(b))}var I=w.forages.slice(0);return h.all(y).then(function(){return l.db=w.db,be(l)}).then(function(E){return l.db=E,F(l,p._defaultConfig.version)?L(l):E}).then(function(E){l.db=w.db=E,p._dbInfo=l;for(var A=0;A<I.length;A++){var N=I[A];N!==p&&(N._dbInfo.db=l.db,N._dbInfo.version=l.version)}})}function Wi(a,p){var l=this;a=C(a);var v=new h(function(w,y){l.ready().then(function(){ce(l._dbInfo,W,function(b,_){if(b)return y(b);try{var k=_.objectStore(l._dbInfo.storeName),I=k.get(a);I.onsuccess=function(){var E=I.result;E===void 0&&(E=null),re(E)&&(E=Y(E)),w(E)},I.onerror=function(){y(I.error)}}catch(E){y(E)}})}).catch(y)});return g(v,p),v}function Ki(a,p){var l=this,v=new h(function(w,y){l.ready().then(function(){ce(l._dbInfo,W,function(b,_){if(b)return y(b);try{var k=_.objectStore(l._dbInfo.storeName),I=k.openCursor(),E=1;I.onsuccess=function(){var A=I.result;if(A){var N=A.value;re(N)&&(N=Y(N));var K=a(N,A.key,E++);K!==void 0?w(K):A.continue()}else w()},I.onerror=function(){y(I.error)}}catch(A){y(A)}})}).catch(y)});return g(v,p),v}function Vi(a,p,l){var v=this;a=C(a);var w=new h(function(y,b){var _;v.ready().then(function(){return _=v._dbInfo,j.call(p)==="[object Blob]"?B(_.db).then(function(k){return k?p:X(p)}):p}).then(function(k){ce(v._dbInfo,S,function(I,E){if(I)return b(I);try{var A=E.objectStore(v._dbInfo.storeName);k===null&&(k=void 0);var N=A.put(k,a);E.oncomplete=function(){k===void 0&&(k=null),y(k)},E.onabort=E.onerror=function(){var K=N.error?N.error:N.transaction.error;b(K)}}catch(K){b(K)}})}).catch(b)});return g(w,l),w}function Ji(a,p){var l=this;a=C(a);var v=new h(function(w,y){l.ready().then(function(){ce(l._dbInfo,S,function(b,_){if(b)return y(b);try{var k=_.objectStore(l._dbInfo.storeName),I=k.delete(a);_.oncomplete=function(){w()},_.onerror=function(){y(I.error)},_.onabort=function(){var E=I.error?I.error:I.transaction.error;y(E)}}catch(E){y(E)}})}).catch(y)});return g(v,p),v}function Yi(a){var p=this,l=new h(function(v,w){p.ready().then(function(){ce(p._dbInfo,S,function(y,b){if(y)return w(y);try{var _=b.objectStore(p._dbInfo.storeName),k=_.clear();b.oncomplete=function(){v()},b.onabort=b.onerror=function(){var I=k.error?k.error:k.transaction.error;w(I)}}catch(I){w(I)}})}).catch(w)});return g(l,a),l}function Hi(a){var p=this,l=new h(function(v,w){p.ready().then(function(){ce(p._dbInfo,W,function(y,b){if(y)return w(y);try{var _=b.objectStore(p._dbInfo.storeName),k=_.count();k.onsuccess=function(){v(k.result)},k.onerror=function(){w(k.error)}}catch(I){w(I)}})}).catch(w)});return g(l,a),l}function Gi(a,p){var l=this,v=new h(function(w,y){if(a<0){w(null);return}l.ready().then(function(){ce(l._dbInfo,W,function(b,_){if(b)return y(b);try{var k=_.objectStore(l._dbInfo.storeName),I=!1,E=k.openKeyCursor();E.onsuccess=function(){var A=E.result;if(!A){w(null);return}a===0||I?w(A.key):(I=!0,A.advance(a))},E.onerror=function(){y(E.error)}}catch(A){y(A)}})}).catch(y)});return g(v,p),v}function Qi(a){var p=this,l=new h(function(v,w){p.ready().then(function(){ce(p._dbInfo,W,function(y,b){if(y)return w(y);try{var _=b.objectStore(p._dbInfo.storeName),k=_.openKeyCursor(),I=[];k.onsuccess=function(){var E=k.result;if(!E){v(I);return}I.push(E.key),E.continue()},k.onerror=function(){w(k.error)}}catch(E){w(E)}})}).catch(w)});return g(l,a),l}function Xi(a,p){p=D.apply(this,arguments);var l=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||l.name,a.storeName=a.storeName||l.storeName);var v=this,w;if(!a.name)w=h.reject("Invalid arguments");else{var y=a.name===l.name&&v._dbInfo.db,b=y?h.resolve(v._dbInfo.db):be(a).then(function(_){var k=P[a.name],I=k.forages;k.db=_;for(var E=0;E<I.length;E++)I[E]._dbInfo.db=_;return _});a.storeName?w=b.then(function(_){if(_.objectStoreNames.contains(a.storeName)){var k=_.version+1;G(a);var I=P[a.name],E=I.forages;_.close();for(var A=0;A<E.length;A++){var N=E[A];N._dbInfo.db=null,N._dbInfo.version=k}var K=new h(function(V,ne){var Z=s.open(a.name,k);Z.onerror=function(pe){var ct=Z.result;ct.close(),ne(pe)},Z.onupgradeneeded=function(){var pe=Z.result;pe.deleteObjectStore(a.storeName)},Z.onsuccess=function(){var pe=Z.result;pe.close(),V(pe)}});return K.then(function(V){I.db=V;for(var ne=0;ne<E.length;ne++){var Z=E[ne];Z._dbInfo.db=V,Q(Z._dbInfo)}}).catch(function(V){throw(de(a,V)||h.resolve()).catch(function(){}),V})}}):w=b.then(function(_){G(a);var k=P[a.name],I=k.forages;_.close();for(var E=0;E<I.length;E++){var A=I[E];A._dbInfo.db=null}var N=new h(function(K,V){var ne=s.deleteDatabase(a.name);ne.onerror=function(){var Z=ne.result;Z&&Z.close(),V(ne.error)},ne.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},ne.onsuccess=function(){var Z=ne.result;Z&&Z.close(),K(Z)}});return N.then(function(K){k.db=K;for(var V=0;V<I.length;V++){var ne=I[V];Q(ne._dbInfo)}}).catch(function(K){throw(de(a,K)||h.resolve()).catch(function(){}),K})})}return g(w,p),w}var Zi={_driver:"asyncStorage",_initStorage:Bi,_support:f(),iterate:Ki,getItem:Wi,setItem:Vi,removeItem:Ji,clear:Yi,length:Hi,key:Gi,keys:Qi,dropInstance:Xi};function es(){return typeof openDatabase=="function"}var Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ts="~~local_forage_type~",hr=/^~~local_forage_type~([^~]+)~/,Et="__lfsc__:",an=Et.length,cn="arbf",ln="blob",pr="si08",gr="ui08",mr="uic8",yr="si16",vr="si32",wr="ur16",br="ui32",xr="fl32",$r="fl64",_r=an+cn.length,Sr=Object.prototype.toString;function kr(a){var p=a.length*.75,l=a.length,v,w=0,y,b,_,k;a[a.length-1]==="="&&(p--,a[a.length-2]==="="&&p--);var I=new ArrayBuffer(p),E=new Uint8Array(I);for(v=0;v<l;v+=4)y=Ae.indexOf(a[v]),b=Ae.indexOf(a[v+1]),_=Ae.indexOf(a[v+2]),k=Ae.indexOf(a[v+3]),E[w++]=y<<2|b>>4,E[w++]=(b&15)<<4|_>>2,E[w++]=(_&3)<<6|k&63;return I}function un(a){var p=new Uint8Array(a),l="",v;for(v=0;v<p.length;v+=3)l+=Ae[p[v]>>2],l+=Ae[(p[v]&3)<<4|p[v+1]>>4],l+=Ae[(p[v+1]&15)<<2|p[v+2]>>6],l+=Ae[p[v+2]&63];return p.length%3===2?l=l.substring(0,l.length-1)+"=":p.length%3===1&&(l=l.substring(0,l.length-2)+"=="),l}function ns(a,p){var l="";if(a&&(l=Sr.call(a)),a&&(l==="[object ArrayBuffer]"||a.buffer&&Sr.call(a.buffer)==="[object ArrayBuffer]")){var v,w=Et;a instanceof ArrayBuffer?(v=a,w+=cn):(v=a.buffer,l==="[object Int8Array]"?w+=pr:l==="[object Uint8Array]"?w+=gr:l==="[object Uint8ClampedArray]"?w+=mr:l==="[object Int16Array]"?w+=yr:l==="[object Uint16Array]"?w+=wr:l==="[object Int32Array]"?w+=vr:l==="[object Uint32Array]"?w+=br:l==="[object Float32Array]"?w+=xr:l==="[object Float64Array]"?w+=$r:p(new Error("Failed to get type for BinaryArray"))),p(w+un(v))}else if(l==="[object Blob]"){var y=new FileReader;y.onload=function(){var b=ts+a.type+"~"+un(this.result);p(Et+ln+b)},y.readAsArrayBuffer(a)}else try{p(JSON.stringify(a))}catch(b){console.error("Couldn't convert value into a JSON string: ",a),p(null,b)}}function rs(a){if(a.substring(0,an)!==Et)return JSON.parse(a);var p=a.substring(_r),l=a.substring(an,_r),v;if(l===ln&&hr.test(p)){var w=p.match(hr);v=w[1],p=p.substring(w[0].length)}var y=kr(p);switch(l){case cn:return y;case ln:return m([y],{type:v});case pr:return new Int8Array(y);case gr:return new Uint8Array(y);case mr:return new Uint8ClampedArray(y);case yr:return new Int16Array(y);case wr:return new Uint16Array(y);case vr:return new Int32Array(y);case br:return new Uint32Array(y);case xr:return new Float32Array(y);case $r:return new Float64Array(y);default:throw new Error("Unkown type: "+l)}}var fn={serialize:ns,deserialize:rs,stringToBuffer:kr,bufferToString:un};function Ir(a,p,l,v){a.executeSql("CREATE TABLE IF NOT EXISTS "+p.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],l,v)}function os(a){var p=this,l={db:null};if(a)for(var v in a)l[v]=typeof a[v]!="string"?a[v].toString():a[v];var w=new h(function(y,b){try{l.db=openDatabase(l.name,String(l.version),l.description,l.size)}catch(_){return b(_)}l.db.transaction(function(_){Ir(_,l,function(){p._dbInfo=l,y()},function(k,I){b(I)})},b)});return l.serializer=fn,w}function Pe(a,p,l,v,w,y){a.executeSql(l,v,w,function(b,_){_.code===_.SYNTAX_ERR?b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[p.storeName],function(k,I){I.rows.length?y(k,_):Ir(k,p,function(){k.executeSql(l,v,w,y)},y)},y):y(b,_)},y)}function is(a,p){var l=this;a=C(a);var v=new h(function(w,y){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(_){Pe(_,b,"SELECT * FROM "+b.storeName+" WHERE key = ? LIMIT 1",[a],function(k,I){var E=I.rows.length?I.rows.item(0).value:null;E&&(E=b.serializer.deserialize(E)),w(E)},function(k,I){y(I)})})}).catch(y)});return g(v,p),v}function ss(a,p){var l=this,v=new h(function(w,y){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(_){Pe(_,b,"SELECT * FROM "+b.storeName,[],function(k,I){for(var E=I.rows,A=E.length,N=0;N<A;N++){var K=E.item(N),V=K.value;if(V&&(V=b.serializer.deserialize(V)),V=a(V,K.key,N+1),V!==void 0){w(V);return}}w()},function(k,I){y(I)})})}).catch(y)});return g(v,p),v}function Er(a,p,l,v){var w=this;a=C(a);var y=new h(function(b,_){w.ready().then(function(){p===void 0&&(p=null);var k=p,I=w._dbInfo;I.serializer.serialize(p,function(E,A){A?_(A):I.db.transaction(function(N){Pe(N,I,"INSERT OR REPLACE INTO "+I.storeName+" (key, value) VALUES (?, ?)",[a,E],function(){b(k)},function(K,V){_(V)})},function(N){if(N.code===N.QUOTA_ERR){if(v>0){b(Er.apply(w,[a,k,l,v-1]));return}_(N)}})})}).catch(_)});return g(y,l),y}function as(a,p,l){return Er.apply(this,[a,p,l,1])}function cs(a,p){var l=this;a=C(a);var v=new h(function(w,y){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(_){Pe(_,b,"DELETE FROM "+b.storeName+" WHERE key = ?",[a],function(){w()},function(k,I){y(I)})})}).catch(y)});return g(v,p),v}function ls(a){var p=this,l=new h(function(v,w){p.ready().then(function(){var y=p._dbInfo;y.db.transaction(function(b){Pe(b,y,"DELETE FROM "+y.storeName,[],function(){v()},function(_,k){w(k)})})}).catch(w)});return g(l,a),l}function us(a){var p=this,l=new h(function(v,w){p.ready().then(function(){var y=p._dbInfo;y.db.transaction(function(b){Pe(b,y,"SELECT COUNT(key) as c FROM "+y.storeName,[],function(_,k){var I=k.rows.item(0).c;v(I)},function(_,k){w(k)})})}).catch(w)});return g(l,a),l}function fs(a,p){var l=this,v=new h(function(w,y){l.ready().then(function(){var b=l._dbInfo;b.db.transaction(function(_){Pe(_,b,"SELECT key FROM "+b.storeName+" WHERE id = ? LIMIT 1",[a+1],function(k,I){var E=I.rows.length?I.rows.item(0).key:null;w(E)},function(k,I){y(I)})})}).catch(y)});return g(v,p),v}function ds(a){var p=this,l=new h(function(v,w){p.ready().then(function(){var y=p._dbInfo;y.db.transaction(function(b){Pe(b,y,"SELECT key FROM "+y.storeName,[],function(_,k){for(var I=[],E=0;E<k.rows.length;E++)I.push(k.rows.item(E).key);v(I)},function(_,k){w(k)})})}).catch(w)});return g(l,a),l}function hs(a){return new h(function(p,l){a.transaction(function(v){v.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(w,y){for(var b=[],_=0;_<y.rows.length;_++)b.push(y.rows.item(_).name);p({db:a,storeNames:b})},function(w,y){l(y)})},function(v){l(v)})})}function ps(a,p){p=D.apply(this,arguments);var l=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||l.name,a.storeName=a.storeName||l.storeName);var v=this,w;return a.name?w=new h(function(y){var b;a.name===l.name?b=v._dbInfo.db:b=openDatabase(a.name,"","",0),a.storeName?y({db:b,storeNames:[a.storeName]}):y(hs(b))}).then(function(y){return new h(function(b,_){y.db.transaction(function(k){function I(K){return new h(function(V,ne){k.executeSql("DROP TABLE IF EXISTS "+K,[],function(){V()},function(Z,pe){ne(pe)})})}for(var E=[],A=0,N=y.storeNames.length;A<N;A++)E.push(I(y.storeNames[A]));h.all(E).then(function(){b()}).catch(function(K){_(K)})},function(k){_(k)})})}):w=h.reject("Invalid arguments"),g(w,p),w}var gs={_driver:"webSQLStorage",_initStorage:os,_support:es(),iterate:ss,getItem:is,setItem:as,removeItem:cs,clear:ls,length:us,key:fs,keys:ds,dropInstance:ps};function ms(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Cr(a,p){var l=a.name+"/";return a.storeName!==p.storeName&&(l+=a.storeName+"/"),l}function ys(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch{return!0}}function vs(){return!ys()||localStorage.length>0}function ws(a){var p=this,l={};if(a)for(var v in a)l[v]=a[v];return l.keyPrefix=Cr(a,p._defaultConfig),vs()?(p._dbInfo=l,l.serializer=fn,h.resolve()):h.reject()}function bs(a){var p=this,l=p.ready().then(function(){for(var v=p._dbInfo.keyPrefix,w=localStorage.length-1;w>=0;w--){var y=localStorage.key(w);y.indexOf(v)===0&&localStorage.removeItem(y)}});return g(l,a),l}function xs(a,p){var l=this;a=C(a);var v=l.ready().then(function(){var w=l._dbInfo,y=localStorage.getItem(w.keyPrefix+a);return y&&(y=w.serializer.deserialize(y)),y});return g(v,p),v}function $s(a,p){var l=this,v=l.ready().then(function(){for(var w=l._dbInfo,y=w.keyPrefix,b=y.length,_=localStorage.length,k=1,I=0;I<_;I++){var E=localStorage.key(I);if(E.indexOf(y)===0){var A=localStorage.getItem(E);if(A&&(A=w.serializer.deserialize(A)),A=a(A,E.substring(b),k++),A!==void 0)return A}}});return g(v,p),v}function _s(a,p){var l=this,v=l.ready().then(function(){var w=l._dbInfo,y;try{y=localStorage.key(a)}catch{y=null}return y&&(y=y.substring(w.keyPrefix.length)),y});return g(v,p),v}function Ss(a){var p=this,l=p.ready().then(function(){for(var v=p._dbInfo,w=localStorage.length,y=[],b=0;b<w;b++){var _=localStorage.key(b);_.indexOf(v.keyPrefix)===0&&y.push(_.substring(v.keyPrefix.length))}return y});return g(l,a),l}function ks(a){var p=this,l=p.keys().then(function(v){return v.length});return g(l,a),l}function Is(a,p){var l=this;a=C(a);var v=l.ready().then(function(){var w=l._dbInfo;localStorage.removeItem(w.keyPrefix+a)});return g(v,p),v}function Es(a,p,l){var v=this;a=C(a);var w=v.ready().then(function(){p===void 0&&(p=null);var y=p;return new h(function(b,_){var k=v._dbInfo;k.serializer.serialize(p,function(I,E){if(E)_(E);else try{localStorage.setItem(k.keyPrefix+a,I),b(y)}catch(A){(A.name==="QuotaExceededError"||A.name==="NS_ERROR_DOM_QUOTA_REACHED")&&_(A),_(A)}})})});return g(w,l),w}function Cs(a,p){if(p=D.apply(this,arguments),a=typeof a!="function"&&a||{},!a.name){var l=this.config();a.name=a.name||l.name,a.storeName=a.storeName||l.storeName}var v=this,w;return a.name?w=new h(function(y){a.storeName?y(Cr(a,v._defaultConfig)):y(a.name+"/")}).then(function(y){for(var b=localStorage.length-1;b>=0;b--){var _=localStorage.key(b);_.indexOf(y)===0&&localStorage.removeItem(_)}}):w=h.reject("Invalid arguments"),g(w,p),w}var Ts={_driver:"localStorageWrapper",_initStorage:ws,_support:ms(),iterate:$s,getItem:xs,setItem:Es,removeItem:Is,clear:bs,length:ks,key:_s,keys:Ss,dropInstance:Cs},Rs=function(p,l){return p===l||typeof p=="number"&&typeof l=="number"&&isNaN(p)&&isNaN(l)},As=function(p,l){for(var v=p.length,w=0;w<v;){if(Rs(p[w],l))return!0;w++}return!1},Tr=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},at={},Rr={},Ze={INDEXEDDB:Zi,WEBSQL:gs,LOCALSTORAGE:Ts},Ps=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],Ct=["dropInstance"],dn=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ct),Ls={description:"",driver:Ps.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Ds(a,p){a[p]=function(){var l=arguments;return a.ready().then(function(){return a[p].apply(a,l)})}}function hn(){for(var a=1;a<arguments.length;a++){var p=arguments[a];if(p)for(var l in p)p.hasOwnProperty(l)&&(Tr(p[l])?arguments[0][l]=p[l].slice():arguments[0][l]=p[l])}return arguments[0]}var Os=function(){function a(p){d(this,a);for(var l in Ze)if(Ze.hasOwnProperty(l)){var v=Ze[l],w=v._driver;this[l]=w,at[w]||this.defineDriver(v)}this._defaultConfig=hn({},Ls),this._config=hn({},this._defaultConfig,p),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(l){if((typeof l>"u"?"undefined":c(l))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var v in l){if(v==="storeName"&&(l[v]=l[v].replace(/\W/g,"_")),v==="version"&&typeof l[v]!="number")return new Error("Database version must be a number.");this._config[v]=l[v]}return"driver"in l&&l.driver?this.setDriver(this._config.driver):!0}else return typeof l=="string"?this._config[l]:this._config},a.prototype.defineDriver=function(l,v,w){var y=new h(function(b,_){try{var k=l._driver,I=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!l._driver){_(I);return}for(var E=dn.concat("_initStorage"),A=0,N=E.length;A<N;A++){var K=E[A],V=!As(Ct,K);if((V||l[K])&&typeof l[K]!="function"){_(I);return}}var ne=function(){for(var ct=function(js){return function(){var Ns=new Error("Method "+js+" is not implemented by the current driver"),Ar=h.reject(Ns);return g(Ar,arguments[arguments.length-1]),Ar}},pn=0,Fs=Ct.length;pn<Fs;pn++){var gn=Ct[pn];l[gn]||(l[gn]=ct(gn))}};ne();var Z=function(ct){at[k]&&console.info("Redefining LocalForage driver: "+k),at[k]=l,Rr[k]=ct,b()};"_support"in l?l._support&&typeof l._support=="function"?l._support().then(Z,_):Z(!!l._support):Z(!0)}catch(pe){_(pe)}});return x(y,v,w),y},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(l,v,w){var y=at[l]?h.resolve(at[l]):h.reject(new Error("Driver not found."));return x(y,v,w),y},a.prototype.getSerializer=function(l){var v=h.resolve(fn);return x(v,l),v},a.prototype.ready=function(l){var v=this,w=v._driverSet.then(function(){return v._ready===null&&(v._ready=v._initDriver()),v._ready});return x(w,l,l),w},a.prototype.setDriver=function(l,v,w){var y=this;Tr(l)||(l=[l]);var b=this._getSupportedDrivers(l);function _(){y._config.driver=y.driver()}function k(A){return y._extend(A),_(),y._ready=y._initStorage(y._config),y._ready}function I(A){return function(){var N=0;function K(){for(;N<A.length;){var V=A[N];return N++,y._dbInfo=null,y._ready=null,y.getDriver(V).then(k).catch(K)}_();var ne=new Error("No available storage method found.");return y._driverSet=h.reject(ne),y._driverSet}return K()}}var E=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=E.then(function(){var A=b[0];return y._dbInfo=null,y._ready=null,y.getDriver(A).then(function(N){y._driver=N._driver,_(),y._wrapLibraryMethodsWithReady(),y._initDriver=I(b)})}).catch(function(){_();var A=new Error("No available storage method found.");return y._driverSet=h.reject(A),y._driverSet}),x(this._driverSet,v,w),this._driverSet},a.prototype.supports=function(l){return!!Rr[l]},a.prototype._extend=function(l){hn(this,l)},a.prototype._getSupportedDrivers=function(l){for(var v=[],w=0,y=l.length;w<y;w++){var b=l[w];this.supports(b)&&v.push(b)}return v},a.prototype._wrapLibraryMethodsWithReady=function(){for(var l=0,v=dn.length;l<v;l++)Ds(this,dn[l])},a.prototype.createInstance=function(l){return new a(l)},a}(),Ms=new Os;o.exports=Ms},{3:3}]},{},[4])(4)})});var oo=J((au,ro)=>{"use strict";var Ue,wa=Xr(),to=eo();ro.exports=Ue={};var z={},Ie={},ge={},ba=3e3,xa=8;console.log("siteAdapter: loading data");var dt=to.createInstance({name:"routes"});dt.iterate(function(t,e,n){z[e]=t}).then(()=>console.log("siteAdapter: data loaded")).catch(t=>console.log("siteAdapter: error loading data ",t));var xn=to.createInstance({name:"withCredentials"});xn.iterate(function(t,e,n){Ie[e]=t}).then(()=>console.log("siteAdapter: withCredentials data loaded")).catch(t=>console.log("siteAdapter: error loading withCredentials data ",t));var bn=function(t,e,n){let r,o=new Promise(function(c,d){let u=setTimeout(function(){clearTimeout(u),d()},ba)}),i=new Promise((c,d)=>$.ajax({type:"GET",url:t,success(){c()},error(){d()}}));r=Promise.race([o,i]).then(()=>e()).catch(()=>n())},no=wa(function(t,e){let n,{site:r}=t;return z[r]&&e(z[r]),r.split(".").at(-1).split(":")[0]==="localhost"?n=`http://${r}/favicon.png`:n=`//${r}/favicon.png`,bn(n,function(){z[r]=n.slice(0,-12),e(n.slice(0,-12))},function(){switch(location.protocol){case"http:":n=`https://${r}/favicon.png`,bn(n,function(){z[r]=`https://${r}`,e(`https://${r}`)},function(){z[r]="",e("")});break;case"https:":return n=`/proxy/${r}/favicon.png`,bn(n,function(){z[r]=`/proxy/${r}`,e(`/proxy/${r}`)},function(){z[r]="",e("")});break;default:z[r]="",e("")}})},xa),ft=(t,e)=>dt.getItem(t).then(function(n){n?(z[t]=n,e(n)):no.push({site:t},function(r){z[t]=r,dt.setItem(t,r).then(o=>e(r)).catch(function(o){console.log("findAdapter setItem error: ",t,o),e(r)})})}).catch(function(n){console.log("findAdapter error: ",t,n),z[t]="",e("")});Ue.local={flag(){return"/favicon.png"},getURL(t){return`/${t}`},getDirectURL(t){return`/${t}`},get(t,e){let n,r=function(o,i){e&&e(o,i)};if(n=localStorage.getItem(t.replace(/\.json$/,""))){let o=JSON.parse(n);r(null,o),e||Promise.resolve(o)}else{let o={msg:`no page named '${t}' in browser local storage`};r(o,null),e||Promise.reject(o)}},put(t,e,n){localStorage.setItem(t,JSON.stringify(e)),n()},delete(t){localStorage.removeItem(t)}};Ue.origin={flag(){return"/favicon.png"},getURL(t){return`/${t}`},getDirectURL(t){return`/${t}`},get(t,e){let n=function(r,o){e&&e(r,o)};$.ajax({type:"GET",dataType:"json",url:`/${t}`,success(r,o,i){t==="system/sitemap.json"?n(null,{data:r,lastModified:Date.parse(i.getResponseHeader("Last-Modified"))}):n(null,r)},error(r,o,i){n({msg:i,xhr:r},null)}})},getIndex(t,e){let n=function(r,o){e&&e(r,o)};$.ajax({type:"GET",dataType:"text",url:`/${t}`,success(r){n(null,r)},error(r,o,i){n({msg:i,xhr:r},null)}})},put(t,e,n){$.ajax({type:"PUT",url:`/page/${t}/action`,data:{action:JSON.stringify(e)},success(){n(null)},error(r,o,i){n({xhr:r,type:o,msg:i})}})},delete(t,e){$.ajax({type:"DELETE",url:`/${t}`,success(){e(null)},error(n,r,o){e({xhr:n,type:r,msg:o})}})}};Ue.recycler={flag(){return"/recycler/favicon.png"},getURL(t){return`/recycler/${t}`},getDirectURL(t){return`/recycler/${t}`},get(t,e){let n=function(r,o){e&&e(r,o)};$.ajax({type:"GET",dataType:"json",url:`/recycler/${t}`,success(r){n(null,r)},error(r,o,i){n({msg:i,xhr:r},null)}})},delete(t,e){$.ajax({type:"DELETE",url:`/recycler/${t}`,success(){e(null)},error(n,r,o){e({xhr:n,type:r,msg:o})}})}};Ue.site=function(t){if(!t||t===window.location.host)return Ue.origin;if(t==="recycler")return Ue.recycler;let e=function(n){let r=document.createElement("canvas");r.width=32,r.height=32;let o=r.getContext("2d"),i=Math.random()*32,c=i,d=Math.random()*32,u=32-d,s=(Math.random()*255<<0).toString(16),f=(Math.random()*255<<0).toString(16),m="#"+s+s+s,h="#"+f+f+f,g=o.createRadialGradient(i,c,32,u,d,0);return g.addColorStop(0,m),g.addColorStop(1,h),o.fillStyle=g,o.fillRect(0,0,32,32),r.toDataURL()};return{flag(){if(z[t]!=null)return z[t]===""?ge[t]?ge[t]:ge[t]=e(t):z[t]+"/favicon.png";if(ge[t])return ge[t];{ft(t,function(r){if(r==="")console.log(`Prefix for ${t} is undetermined...`);else{console.log(`Prefix for ${t} is ${r}`);let o=ge[t],i=z[t]+"/favicon.png";$('img[src="'+o+'"]').attr("src",i),$('a[target="'+t+'"]').attr("style","background-image: url("+i+")"),ge[t]=null}});let n=e(t);return ge[t]=n,n}},getURL(n){return z[t]!=null?z[t]===""?(console.log(`${t} is unreachable, can't link to ${n}`),""):`${z[t]}/${n}`:(ft(t,function(r){r===""?console.log(`${t} is unreachable`):(console.log(`Prefix for ${t} is ${r}, about to fixup links`),$('a[target="'+t+'"]').each(function(){let o;/proxy/.test(r)?o=`http://${r.substring(7)}`:o=r,$(this).attr("href",`${o}/${$(this).data("slug")}.html`)}))}),"")},getDirectURL(n){let r,o;return z[t]!=null?z[t]===""?(console.log(`${t} is unreachable, can't link to ${n}`),""):(/proxy/.test(z[t])?(o=z[t].substring(7),r=`http://${o}`):r=z[t],`${r}/${n}`):(ft(t,function(i){i===""?console.log(`${t} is unreachable`):(console.log(`Prefix for ${t} is ${i}, about to fixup links`),$('a[target="'+t+'"]').each(function(){/proxy/.test(i)?(o=i.substring(7),r=`http://${o}`):r=i,$(this).attr("href",`${r}/${$(this).data("slug")}.html`)}))}),"")},get(n,r){let o,i=function(d,u){r&&r(d,u)};var c=function(d,u){let s=`${z[t]}/${d}`,f=Ie[t]||!1;$.ajax({type:"GET",dataType:"json",url:s,xhrFields:{withCredentials:f},success(m,h,g){if((d==="system/sitemap.json"&&Array.isArray(m)&&m[0]==="Login Required"||m.title==="Login Required")&&!s.includes("login-required")&&Ie[t]!==!0)Ie[t]=!0,c(d,function(x,C){x?(Ie[t]=!1,u(x,C)):(xn.setItem(t,!0),u(x,C))});else if(d==="system/sitemap.json"?u(null,{data:m,lastModified:Date.parse(g.getResponseHeader("Last-Modified"))}):u(null,m),!r)return Promise.resolve(m)},error(m,h,g){if(u({msg:g,xhr:m},null),!r)return Promise.reject(g)}})};if(z[t]!=null)if(z[t]===""){if(console.log(`${t} is unreachable`),o={msg:`${t} is unreachable`,xhr:{status:0}},i(o,null),!r)return Promise.reject(o)}else return c(n,i);else ft(t,function(d){if(d===""){if(console.log(`${t} is unreachable`),o={msg:`${t} is unreachable`,xhr:{status:0}},i(o,null),!r)return Promise.reject(o)}else return c(n,i)})},getIndex(n,r){let o,i=function(d,u){r&&r(d,u)};var c=function(d,u){let s=`${z[t]}/${d}`,f=Ie[t]||!1;$.ajax({type:"GET",dataType:"text",url:s,xhrFields:{withCredentials:f},success(m){if(m.title==="Login Required"&&!s.includes("login-required")&&Ie[t]!==!0)return Ie[t]=!0,c(d,function(h,g){h?(Ie[t]=!1,u(h,g)):(xn.setItem(t,!0),u(h,g))});if(u(null,m),!r)return Promise.resolve(m)},error(m,h,g){if(u({msg:g,xhr:m},null),!r)return Promise.reject(g)}})};if(z[t]!=null)if(z[t]===""){if(console.log(`${t} is unreachable`),o={msg:`${t} is unreachable`,xhr:{status:0}},i(o,null),!r)return Promise.reject(o)}else return c(n,i);else ft(t,function(d){if(d===""){if(console.log(`${t} is unreachable`),o={msg:`${t} is unreachable`,xhr:{status:0}},i(o,null),!r)return Promise.reject(o)}else return c(n,i)})},refresh(n){if(console.log(`Refreshing ${t}`),ge[t]==null){let r=e(t);ge[t]=r;let o=z[t]+"/favicon.png";$('img[src="'+o+'"]').attr("src",r),$('a[target="'+t+'"]').attr("style","background-image: url("+r+")")}z[t]=null,dt.removeItem(t).then(()=>{no.push({site:t},r=>{dt.setItem(t,r).then(()=>{if(r==="")console.log(`Refreshed prefix for ${t} is undetermined...`);else{console.log(`Refreshed prefix for ${t} is ${r}`);let o=ge[t],i=z[t]+"/favicon.png";$('img[src="'+o+'"]').attr("src",i),$('a[target="'+t+'"]').attr("style","background-image: url("+i+")")}n()}).catch(o=>{console.log("findAdapter setItem error: ",t,o),z[t]="",n()})})}).catch(r=>{console.log("refresh error ",t,r),n()})}}}});var ht={};le(ht,{formatActionTitle:()=>_n,formatDate:()=>$n,formatDelay:()=>Sa,formatElapsedTime:()=>_a,formatTime:()=>$a});function $a(t){let e=new Date(t>1e10?t:t*1e3),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],r=e.getHours(),o=r<12?"AM":"PM";r=r===0?12:r>12?r-12:r;let i=(e.getMinutes()<10?"0":"")+e.getMinutes();return`${r}:${i} ${o}<br>${e.getDate()} ${n} ${e.getFullYear()}`}function $n(t){let e=new Date(t),n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate(),i=e.getFullYear(),c=e.getHours(),d=c<12?"AM":"PM";c=c===0?12:c>12?c-12:c;let u=(e.getMinutes()<10?"0":"")+e.getMinutes(),s=(e.getSeconds()<10?"0":"")+e.getSeconds();return`${n} ${r} ${o}, ${i}<br>${c}:${u}:${s} ${d}`}function _n(t){let e="";return t.site&&(e+=`${t.site}
`),e+=t.type||"separator",t.date&&(e+=` ${util.formatElapsedTime(t.date)}`),t.attribution?.page&&(e+=`
from ${t.attribution.page}`),t.removedTo?.page&&(e+=`
to ${t.removedTo.page}`),e}function _a(t){let e,n,r,o,i,c,d,u=new Date().getTime()-t;return(i=u/1e3)<2?`${Math.floor(u)} milliseconds ago`:(r=i/60)<2?`${Math.floor(i)} seconds ago`:(n=r/60)<2?`${Math.floor(r)} minutes ago`:(e=n/24)<2?`${Math.floor(n)} hours ago`:(c=e/7)<2?`${Math.floor(e)} days ago`:(o=e/31)<2?`${Math.floor(c)} weeks ago`:(d=e/365)<2?`${Math.floor(o)} months ago`:`${Math.floor(d)} years ago`}function Sa(t){let e,n,r,o=t-Date.now();return(r=o/1e3)<2?`in ${Math.floor(o)} milliseconds`:(n=r/60)<2?`in ${Math.floor(r)} seconds`:(e=n/60)<2?`in ${Math.floor(n)} minutes`:`in ${Math.floor(e)} hours`}var Be=oe(()=>{"use strict"});var ao={};le(ao,{itemId:()=>ue,randomByte:()=>io,randomBytes:()=>so});function io(){return((1+Math.random())*256|0).toString(16).substring(1)}function so(t){return[...Array(t)].map(e=>io()).join("")}function ue(){return so(8)}var We=oe(()=>{"use strict"});var co={};le(co,{apply:()=>jt,create:()=>Sn});function jt(t,e){let n,r=()=>(t.story||[]).map(u=>u?.id),o=function(u,s){let f=r().indexOf(u)+1;t.story.splice(f,0,s)},i=function(){let u;(u=r().indexOf(e.id))!==-1&&t.story.splice(u,1)};switch(t.story||(t.story=[]),e.type){case"create":e.item&&(e.item.title&&(t.title=e.item.title),e.item.story&&(t.story=e.item.story.slice()));break;case"add":o(e.after,e.item);break;case"edit":(n=r().indexOf(e.id))!==-1?t.story.splice(n,1,e.item):t.story.push(e.item);break;case"move":n=e.order.indexOf(e.id);var c=e.order[n-1],d=t.story[r().indexOf(e.id)];i(),o(c,d);break;case"remove":i();break}t.journal||(t.journal=[]),e.fork&&t.journal.push({type:"fork",site:e.fork,date:e.date-1}),t.journal.push(e)}function Sn(t,e){t=+t;let n=e.journal.slice(0,+t+1||void 0),r={title:e.title,story:[]};for(var o of n)jt(r,o||{});return r}var kn=oe(()=>{"use strict"});var En={};le(En,{default:()=>In});function In(t){let{synopsis:e}=t;if(t?.story){let n=t.story[0],r=t.story[1];n&&n.type==="paragraph"&&(e||=n.text),r&&r.type==="paragraph"&&(e||=r.text),n&&n.text&&(e||=n.text),r&&r.text&&(e||=r.text),e||=t.story&&`A page with ${t.story.length} items.`}else e="A page with no story.";return e=e.trim().split(/\r|\n/,1)[0],e.substring(0,560)}var Nt=oe(()=>{"use strict"});var De={};le(De,{asSlug:()=>me,asTitle:()=>Cn,newPage:()=>et,pageEmitter:()=>pt});var pt,me,Cn,ka,et,ye=oe(()=>{"use strict";Be();We();kn();Nt();pt=new EventTarget,me=t=>t.replace(/\s/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase(),Cn=t=>t.replace(/-/g," "),ka=t=>[{symbol:"\u2744",date:t-1e3*60*60*24*366,period:"a Year"},{symbol:"\u2698",date:t-1e3*60*60*24*31*3,period:"a Season"},{symbol:"\u26AA",date:t-1e3*60*60*24*31,period:"a Month"},{symbol:"\u263D",date:t-1e3*60*60*24*7,period:"a Week"},{symbol:"\u2600",date:t-1e3*60*60*24,period:"a Day"},{symbol:"\u231A",date:t-1e3*60*60,period:"an Hour"}],et=function(t,e){let n=t||{};n.title||(n.title="empty"),n.story||(n.story=[]),n.journal||(n.journal=[]);let r=()=>n,o=function(){let L=["view"];c()&&L.push(e);let F=function(Y){Y&&!L.includes(Y)&&L.push(Y)};for(var X of n.journal.slice(0).reverse())F(X?.site);return L},i=()=>n.plugin!=null;var c=()=>![void 0,null,"view","origin","local","recycler"].includes(e);let d=()=>e==="local",u=()=>e==="recycler",s=function(L=null){return c()?e:L},f=function(L=null){let F=[];return(L||c())&&F.push(s(L)),i()&&F.push(`${n.plugin} plugin`),F.join(`
`)},m=()=>me(n.title),h=function(L){let F=[];c()?F.push(e):L&&F.push(L);for(var X of n.story)X?.site&&F.push(X.site);for(var Y of n.journal)Y?.site&&F.push(Y.site);return Array.from(new Set(F))},g=()=>n.title,x=L=>n.title=L,C=()=>n.journal.length-1,D=function(){let L=n.journal[C()];if(L&&L.date)return L.date},R=function(){let L=n.journal[C()];return L?L.date?$n(L.date):`Revision ${C()}`:"Unrecorded Date"},T=()=>In(n),P=function(){let L,F,X=function(Y,re,xe,Xe){try{let ce=/\[\[([^\]]+)\]\]/g,$e;for(;($e=ce.exec(re.text))!==null;)Y.has(me($e[1]))||Y.set(me($e[1]),re.id);re.type==="reference"&&(Y.has(re.slug)||Y.set(re.slug,re.id))}catch(ce){console.log(`*** Error extracting links from ${xe} of ${JSON.stringify(Xe)}`,ce.message)}return Y};try{F=n.story.reduce(X,new Map)}catch(Y){let re=Y;console.log(`+++ Extract links on ${n.slug} fails`,re)}return F.size>0?L=Object.fromEntries(F):L={},L},j=function(L){L=Object.assign({},{id:ue()},L),n.story.push(L)},W=function(L){for(var F of n.story)if(F.id===L)return F;return null},S=function(L){return new Promise(function(X,Y){var re=function(xe){return xe>=n.story.length?X():L(n.story[xe]||{text:"null"},()=>re(xe+1))};return re(0)})},O=function(L){j({type:"paragraph",text:L})},M=function(L){let F=0,X=ka(new Date().getTime());var Y=function(re){if(re>=n.journal.length)return;let xe=n.journal[re]||{},Xe=xe.date||0,ce=null;for(var $e of X)$e.date>F&&$e.date<Xe&&(ce=$e);F=Xe,L({action:xe,separator:ce},()=>Y(re+1))};Y(0)},B=function(L,F){n.story=L?.getRawPage().story||[],F&&(n.journal=F?.getRawPage().journal)},G=function(){let L=m(),F=L==="welcome-visitors"?"view/welcome-visitors":`view/welcome-visitors/view/${L}`;return c()?wiki.site(e).getDirectURL(F):`/${F}`},Q=function(L,F){for(var X of L)if(X.id===F.id&&X.date===F.date)return!1;return!0};return{getRawPage:r,getContext:o,isPlugin:i,isRemote:c,isLocal:d,isRecycler:u,getRemoteSite:s,getRemoteSiteDetails:f,getSlug:m,getNeighbors:h,getTitle:g,getLinks:P,setTitle:x,getRevision:C,getDate:D,getTimestamp:R,getSynopsis:T,addItem:j,getItem:W,addParagraph:O,seqItems:S,seqActions:M,become:B,siteLineup:G,merge:function(L){let F,X=n.journal.slice();for(F of L.getRawPage().journal)Q(n.journal,F)&&X.push(F);X.push({type:"fork",site:L.getRemoteSite(),date:new Date().getTime()}),et(Sn(999,{title:n.title,journal:X}),e)},apply:function(L){jt(n,L),L.site&&(e=null)},getCreate:function(){let L=F=>F.type==="create";n.journal.reverse().find(L)}}}});var gt=J((du,lo)=>{"use strict";var Ke;lo.exports=Ke={};Ke.scrollContainer=void 0;var Ia=function(){let t=$("body, html").filter(function(){return $(this).scrollLeft()>0});return t.length>0?t:$("body, html").scrollLeft(12).filter(function(){return $(this).scrollLeft()>0}).scrollTop(0)},Ea=function(t){let e;if(t.position()==null)return;Ke.scrollContainer==null&&(Ke.scrollContainer=Ia());let n=$("body").width(),r=Ke.scrollContainer.scrollLeft(),o=r+n,i=t.position().left,c=t.outerWidth(!0),d=$(".page").outerWidth(!0)*$(".page").length;i<r?e=i:i+c>o?e=i-(n-c):o>$(".pages").outerWidth()&&(e=Math.min(i,d-n)),Ke.scrollContainer.animate({scrollLeft:e},function(){$.contains(t[0],document.activeElement)||t.trigger("focus")})};Ke.set=function(t,e){$(".incremental-search").remove(),t=$(t),$(".active").removeClass("active"),t.addClass("active"),e||Ea(t)}});var Ee=J((hu,ho)=>{"use strict";var{randomBytes:Ca}=(We(),q(ao)),Ve={},ee=[],Ta=function(t){let e=Ca(4);return Ve[e]=t,ee.push(e),e},Ra=function(t,e){let n=ee.indexOf(t);ee.splice(n,1),ee.splice(e,0,t)},Aa=function(t){return ee.includes(t)?(ee=ee.filter(e=>t!==e),delete Ve[t],t):null},Pa=function(t){let e=[];if(!ee.includes(t))return e;for(;ee[ee.length-1]!==t;){var n=ee.pop();e.unshift(n),delete Ve[n]}return e},uo=t=>Ve[t],fo=t=>uo(t).getTitle(),La=function(){return ee.length?fo(ee[ee.length-1]):"Wiki"},Da=()=>ee,Oa=function(){Ve={},ee=[]},Ma=function(t){let e,n,r;(e=`${ee}`)!=(r=`${t}`)&&(console.log("The lineup is out of sync with the dom."),console.log(".pages:",t),console.log("lineup:",ee),`${Object.keys(ee).sort()}`==`${Object.keys(t).sort()}`&&(console.log("It looks like an ordering problem we can fix."),n=t))},Fa=function(t){let e=ee.indexOf(t);return e<1?null:ee[e-1]},ja=function(t,e){let n,r,o=Ve[t],i=o.getRemoteSite(e),c=["view",r=o.getSlug()];if(r!=="welcome-visitors"&&c.unshift("view","welcome-visitors"),i!==e&&(n=Fa(t))){let d;(d=Ve[n]).isRemote()||c.push(e,d.getSlug())}return c.unshift(i),c};ho.exports={addPage:Ta,changePageIndex:Ra,removeKey:Aa,removeAllAfterKey:Pa,atKey:uo,titleAtKey:fo,bestTitle:La,debugKeys:Da,debugReset:Oa,crumbs:ja,debugSelfCheck:Ma}});var mt=J((pu,po)=>{"use strict";var te,Na=gt(),qt=Ee(),Tn=null;po.exports=te={};te.inject=t=>Tn=t;te.pagesInDom=()=>Array.from(document.querySelectorAll(".page")).map(t=>t.id);te.urlPages=()=>new URL(window.location.href).pathname.split("/").slice(1).filter((...[,e])=>e%2===1);te.locsInDom=()=>$.makeArray($(".page").map((t,e)=>$(e).data("site")||"view"));te.urlLocs=()=>new URL(window.location.href).pathname.split("/").slice(1).filter((...[,e])=>e%2===0);te.setUrl=()=>{if(document.title=qt.bestTitle(),history&&history.pushState){let t=te.locsInDom(),n=te.pagesInDom().map((r,o)=>`/${t[o]||"view"}/${r}`).join("");n!==new URL(window.location.href).pathname&&history.pushState(null,null,n)}};te.debugStates=()=>{console.log("a .page keys ",Array.from($(".page")).map(t=>$(t).data("key"))),console.log("a lineup keys",qt.debugKeys())};te.show=t=>{let e=te.pagesInDom(),n=te.urlPages(),r=te.locsInDom(),o=te.urlLocs();if(!location.pathname||location.pathname==="/")return;let i=!0;for(let[c,d]of e.entries()){if(i&&(i=d===n[c]))continue;let u=$(".page:last");qt.removeKey(u.data("key")),u.remove()}i=!0;for(let[c,d]of n.entries())i&&(i=d===e[c])||Tn.showPage(d,o[c]);window.debug&&te.debugStates(),Na.set($(".page").last()),document.title=qt.bestTitle()};te.first=()=>{te.setUrl();let t=te.urlPages(),e=te.urlLocs(),n=te.pagesInDom();for(let r=0;r<t.length;r++){let o=t[r];!n.includes(o)&&o!==""&&Tn.createPage(o,e[r])}}});var Ce,Rn=oe(()=>{"use strict";Ce=class{static symbols={create:"\u263C",add:"+",edit:"\u270E",fork:"\u2691",move:"\u2195",remove:"\u2715",copyIn:"\u2A2D",copyOut:"\u2A35"};static fork="\u2691";static add="+"}});var go={};le(go,{default:()=>zt});function zt(t,e){let n=t.parents(".page:first"),r=$('<a href="#" /> ').addClass("action").addClass(e.type||"separator").text(e.symbol||Ce.symbols[e.type]).attr("title",_n(e)).attr("data-id",e.id||"0").attr("data-date",e.date||"0").data("action",e);e.type==="add"&&e.attribution&&(r.text(Ce.symbols.copyIn),e.attribution.site&&r.css("background-image",`url(${wiki.site(e.attribution.site).flag()})`)),e.type==="remove"&&e.removedTo&&r.text(Ce.symbols.copyOut);let o=t.children(".control-buttons");o.length>0?r.insertBefore(o):r.appendTo(t),e.type==="fork"&&e.site&&r.css("background-image",`url(${wiki.site(e.site).flag()}`).attr("href",`${wiki.site(e.site).getDirectURL(n.attr("id"))}.html`).attr("target",`${e.site}`).data("site",e.site).data("slug",n.attr("id"))}var An=oe(()=>{"use strict";Be();Rn()});var Co=J((wu,Eo)=>{"use strict";function Wt(t,e,n,r){function o(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function d(f){try{s(r.next(f))}catch(m){c(m)}}function u(f){try{s(r.throw(f))}catch(m){c(m)}}function s(f){f.done?i(f.value):o(f.value).then(d,u)}s((r=r.apply(t,e||[])).next())})}var qa="ENTRIES",bo="KEYS",xo="VALUES",se="",yt=class{constructor(e,n){let r=e._tree,o=Array.from(r.keys());this.set=e,this._type=n,this._path=o.length>0?[{node:r,keys:o}]:[]}next(){let e=this.dive();return this.backtrack(),e}dive(){if(this._path.length===0)return{done:!0,value:void 0};let{node:e,keys:n}=tt(this._path);if(tt(n)===se)return{done:!1,value:this.result()};let r=e.get(tt(n));return this._path.push({node:r,keys:Array.from(r.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;let e=tt(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:e})=>tt(e)).filter(e=>e!==se).join("")}value(){return tt(this._path).node.get(se)}result(){switch(this._type){case xo:return this.value();case bo:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}},tt=t=>t[t.length-1],za=(t,e,n)=>{let r=new Map;if(e===void 0)return r;let o=e.length+1,i=o+n,c=new Uint8Array(i*o).fill(n+1);for(let d=0;d<o;++d)c[d]=d;for(let d=1;d<i;++d)c[d*o]=d;return $o(t,e,n,r,c,1,o,""),r},$o=(t,e,n,r,o,i,c,d)=>{let u=i*c;e:for(let s of t.keys())if(s===se){let f=o[u-1];f<=n&&r.set(d,[t.get(s),f])}else{let f=i;for(let m=0;m<s.length;++m,++f){let h=s[m],g=c*f,x=g-c,C=o[g],D=Math.max(0,f-n-1),R=Math.min(c-1,f+n);for(let T=D;T<R;++T){let P=h!==e[T],j=o[x+T]+ +P,W=o[x+T+1]+1,S=o[g+T]+1,O=o[g+T+1]=Math.min(j,W,S);O<C&&(C=O)}if(C>n)continue e}$o(t.get(s),e,n,r,o,f,c,d+s)}},vt=class t{constructor(e=new Map,n=""){this._size=void 0,this._tree=e,this._prefix=n}atPrefix(e){if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");let[n,r]=Kt(this._tree,e.slice(this._prefix.length));if(n===void 0){let[o,i]=Nn(r);for(let c of o.keys())if(c!==se&&c.startsWith(i)){let d=new Map;return d.set(c.slice(i.length),o.get(c)),new t(d,e)}}return new t(n,e)}clear(){this._size=void 0,this._tree.clear()}delete(e){return this._size=void 0,Ua(this._tree,e)}entries(){return new yt(this,qa)}forEach(e){for(let[n,r]of this)e(n,r,this)}fuzzyGet(e,n){return za(this._tree,e,n)}get(e){let n=Mn(this._tree,e);return n!==void 0?n.get(se):void 0}has(e){let n=Mn(this._tree,e);return n!==void 0&&n.has(se)}keys(){return new yt(this,bo)}set(e,n){if(typeof e!="string")throw new Error("key must be a string");return this._size=void 0,Pn(this._tree,e).set(se,n),this}get size(){if(this._size)return this._size;this._size=0;let e=this.entries();for(;!e.next().done;)this._size+=1;return this._size}update(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;let r=Pn(this._tree,e);return r.set(se,n(r.get(se))),this}fetch(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;let r=Pn(this._tree,e),o=r.get(se);return o===void 0&&r.set(se,o=n()),o}values(){return new yt(this,xo)}[Symbol.iterator](){return this.entries()}static from(e){let n=new t;for(let[r,o]of e)n.set(r,o);return n}static fromObject(e){return t.from(Object.entries(e))}},Kt=(t,e,n=[])=>{if(e.length===0||t==null)return[t,n];for(let r of t.keys())if(r!==se&&e.startsWith(r))return n.push([t,r]),Kt(t.get(r),e.slice(r.length),n);return n.push([t,e]),Kt(void 0,"",n)},Mn=(t,e)=>{if(e.length===0||t==null)return t;for(let n of t.keys())if(n!==se&&e.startsWith(n))return Mn(t.get(n),e.slice(n.length))},Pn=(t,e)=>{let n=e.length;e:for(let r=0;t&&r<n;){for(let i of t.keys())if(i!==se&&e[r]===i[0]){let c=Math.min(n-r,i.length),d=1;for(;d<c&&e[r+d]===i[d];)++d;let u=t.get(i);if(d===i.length)t=u;else{let s=new Map;s.set(i.slice(d),u),t.set(e.slice(r,r+d),s),t.delete(i),t=s}r+=d;continue e}let o=new Map;return t.set(e.slice(r),o),o}return t},Ua=(t,e)=>{let[n,r]=Kt(t,e);if(n!==void 0){if(n.delete(se),n.size===0)_o(r);else if(n.size===1){let[o,i]=n.entries().next().value;So(r,o,i)}}},_o=t=>{if(t.length===0)return;let[e,n]=Nn(t);if(e.delete(n),e.size===0)_o(t.slice(0,-1));else if(e.size===1){let[r,o]=e.entries().next().value;r!==se&&So(t.slice(0,-1),r,o)}},So=(t,e,n)=>{if(t.length===0)return;let[r,o]=Nn(t);r.set(o+e,n),r.delete(o)},Nn=t=>t[t.length-1],qn="or",ko="and",Ba="and_not",Vt=class t{constructor(e){if(e?.fields==null)throw new Error('MiniSearch: option "fields" must be provided');let n=e.autoVacuum==null||e.autoVacuum===!0?On:e.autoVacuum;this._options=Object.assign(Object.assign(Object.assign({},Dn),e),{autoVacuum:n,searchOptions:Object.assign(Object.assign({},mo),e.searchOptions||{}),autoSuggestOptions:Object.assign(Object.assign({},Ya),e.autoSuggestOptions||{})}),this._index=new vt,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=jn,this.addFields(this._options.fields)}add(e){let{extractField:n,tokenize:r,processTerm:o,fields:i,idField:c}=this._options,d=n(e,c);if(d==null)throw new Error(`MiniSearch: document does not have ID field "${c}"`);if(this._idToShortId.has(d))throw new Error(`MiniSearch: duplicate ID ${d}`);let u=this.addDocumentId(d);this.saveStoredFields(u,e);for(let s of i){let f=n(e,s);if(f==null)continue;let m=r(f.toString(),s),h=this._fieldIds[s],g=new Set(m).size;this.addFieldLength(u,h,this._documentCount-1,g);for(let x of m){let C=o(x,s);if(Array.isArray(C))for(let D of C)this.addTerm(h,u,D);else C&&this.addTerm(h,u,C)}}}addAll(e){for(let n of e)this.add(n)}addAllAsync(e,n={}){let{chunkSize:r=10}=n,o={chunk:[],promise:Promise.resolve()},{chunk:i,promise:c}=e.reduce(({chunk:d,promise:u},s,f)=>(d.push(s),(f+1)%r===0?{chunk:[],promise:u.then(()=>new Promise(m=>setTimeout(m,0))).then(()=>this.addAll(d))}:{chunk:d,promise:u}),o);return c.then(()=>this.addAll(i))}remove(e){let{tokenize:n,processTerm:r,extractField:o,fields:i,idField:c}=this._options,d=o(e,c);if(d==null)throw new Error(`MiniSearch: document does not have ID field "${c}"`);let u=this._idToShortId.get(d);if(u==null)throw new Error(`MiniSearch: cannot remove document with ID ${d}: it is not in the index`);for(let s of i){let f=o(e,s);if(f==null)continue;let m=n(f.toString(),s),h=this._fieldIds[s],g=new Set(m).size;this.removeFieldLength(u,h,this._documentCount,g);for(let x of m){let C=r(x,s);if(Array.isArray(C))for(let D of C)this.removeTerm(h,u,D);else C&&this.removeTerm(h,u,C)}}this._storedFields.delete(u),this._documentIds.delete(u),this._idToShortId.delete(d),this._fieldLength.delete(u),this._documentCount-=1}removeAll(e){if(e)for(let n of e)this.remove(n);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new vt,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(e){let n=this._idToShortId.get(e);if(n==null)throw new Error(`MiniSearch: cannot discard document with ID ${e}: it is not in the index`);this._idToShortId.delete(e),this._documentIds.delete(n),this._storedFields.delete(n),(this._fieldLength.get(n)||[]).forEach((r,o)=>{this.removeFieldLength(n,o,this._documentCount,r)}),this._fieldLength.delete(n),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;let{minDirtFactor:e,minDirtCount:n,batchSize:r,batchWait:o}=this._options.autoVacuum;this.conditionalVacuum({batchSize:r,batchWait:o},{minDirtCount:n,minDirtFactor:e})}discardAll(e){let n=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(let r of e)this.discard(r)}finally{this._options.autoVacuum=n}this.maybeAutoVacuum()}replace(e){let{idField:n,extractField:r}=this._options,o=r(e,n);this.discard(o),this.add(e)}vacuum(e={}){return this.conditionalVacuum(e)}conditionalVacuum(e,n){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&n,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{let r=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=jn,this.performVacuuming(e,r)}),this._enqueuedVacuum)):this.vacuumConditionsMet(n)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)}performVacuuming(e,n){return Wt(this,void 0,void 0,function*(){let r=this._dirtCount;if(this.vacuumConditionsMet(n)){let o=e.batchSize||Fn.batchSize,i=e.batchWait||Fn.batchWait,c=1;for(let[d,u]of this._index){for(let[s,f]of u)for(let[m]of f)this._documentIds.has(m)||(f.size<=1?u.delete(s):f.delete(m));this._index.get(d).size===0&&this._index.delete(d),c%o===0&&(yield new Promise(s=>setTimeout(s,i))),c+=1}this._dirtCount-=r}yield null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null})}vacuumConditionsMet(e){if(e==null)return!0;let{minDirtCount:n,minDirtFactor:r}=e;return n=n||On.minDirtCount,r=r||On.minDirtFactor,this.dirtCount>=n&&this.dirtFactor>=r}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(e){return this._idToShortId.has(e)}getStoredFields(e){let n=this._idToShortId.get(e);if(n!=null)return this._storedFields.get(n)}search(e,n={}){let r=this.executeQuery(e,n),o=[];for(let[i,{score:c,terms:d,match:u}]of r){let s=d.length||1,f={id:this._documentIds.get(i),score:c*s,terms:Object.keys(u),queryTerms:d,match:u};Object.assign(f,this._storedFields.get(i)),(n.filter==null||n.filter(f))&&o.push(f)}return e===t.wildcard&&n.boostDocument==null&&this._options.searchOptions.boostDocument==null||o.sort(vo),o}autoSuggest(e,n={}){n=Object.assign(Object.assign({},this._options.autoSuggestOptions),n);let r=new Map;for(let{score:i,terms:c}of this.search(e,n)){let d=c.join(" "),u=r.get(d);u!=null?(u.score+=i,u.count+=1):r.set(d,{score:i,terms:c,count:1})}let o=[];for(let[i,{score:c,terms:d,count:u}]of r)o.push({suggestion:i,terms:d,score:c/u});return o.sort(vo),o}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(e,n){if(n==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),n)}static loadJSONAsync(e,n){return Wt(this,void 0,void 0,function*(){if(n==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(e),n)})}static getDefault(e){if(Dn.hasOwnProperty(e))return Ln(Dn,e);throw new Error(`MiniSearch: unknown option "${e}"`)}static loadJS(e,n){let{index:r,documentIds:o,fieldLength:i,storedFields:c,serializationVersion:d}=e,u=this.instantiateMiniSearch(e,n);u._documentIds=Ut(o),u._fieldLength=Ut(i),u._storedFields=Ut(c);for(let[s,f]of u._documentIds)u._idToShortId.set(f,s);for(let[s,f]of r){let m=new Map;for(let h of Object.keys(f)){let g=f[h];d===1&&(g=g.ds),m.set(parseInt(h,10),Ut(g))}u._index.set(s,m)}return u}static loadJSAsync(e,n){return Wt(this,void 0,void 0,function*(){let{index:r,documentIds:o,fieldLength:i,storedFields:c,serializationVersion:d}=e,u=this.instantiateMiniSearch(e,n);u._documentIds=yield Bt(o),u._fieldLength=yield Bt(i),u._storedFields=yield Bt(c);for(let[f,m]of u._documentIds)u._idToShortId.set(m,f);let s=0;for(let[f,m]of r){let h=new Map;for(let g of Object.keys(m)){let x=m[g];d===1&&(x=x.ds),h.set(parseInt(g,10),yield Bt(x))}++s%1e3===0&&(yield Io(0)),u._index.set(f,h)}return u})}static instantiateMiniSearch(e,n){let{documentCount:r,nextId:o,fieldIds:i,averageFieldLength:c,dirtCount:d,serializationVersion:u}=e;if(u!==1&&u!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");let s=new t(n);return s._documentCount=r,s._nextId=o,s._idToShortId=new Map,s._fieldIds=i,s._avgFieldLength=c,s._dirtCount=d||0,s._index=new vt,s}executeQuery(e,n={}){if(e===t.wildcard)return this.executeWildcardQuery(n);if(typeof e!="string"){let h=Object.assign(Object.assign(Object.assign({},n),e),{queries:void 0}),g=e.queries.map(x=>this.executeQuery(x,h));return this.combineResults(g,h.combineWith)}let{tokenize:r,processTerm:o,searchOptions:i}=this._options,c=Object.assign(Object.assign({tokenize:r,processTerm:o},i),n),{tokenize:d,processTerm:u}=c,m=d(e).flatMap(h=>u(h)).filter(h=>!!h).map(Ja(c)).map(h=>this.executeQuerySpec(h,c));return this.combineResults(m,c.combineWith)}executeQuerySpec(e,n){let r=Object.assign(Object.assign({},this._options.searchOptions),n),o=(r.fields||this._options.fields).reduce((C,D)=>Object.assign(Object.assign({},C),{[D]:Ln(r.boost,D)||1}),{}),{boostDocument:i,weights:c,maxFuzzy:d,bm25:u}=r,{fuzzy:s,prefix:f}=Object.assign(Object.assign({},mo.weights),c),m=this._index.get(e.term),h=this.termResults(e.term,e.term,1,e.termBoost,m,o,i,u),g,x;if(e.prefix&&(g=this._index.atPrefix(e.term)),e.fuzzy){let C=e.fuzzy===!0?.2:e.fuzzy,D=C<1?Math.min(d,Math.round(e.term.length*C)):C;D&&(x=this._index.fuzzyGet(e.term,D))}if(g)for(let[C,D]of g){let R=C.length-e.term.length;if(!R)continue;x?.delete(C);let T=f*C.length/(C.length+.3*R);this.termResults(e.term,C,T,e.termBoost,D,o,i,u,h)}if(x)for(let C of x.keys()){let[D,R]=x.get(C);if(!R)continue;let T=s*C.length/(C.length+R);this.termResults(e.term,C,T,e.termBoost,D,o,i,u,h)}return h}executeWildcardQuery(e){let n=new Map,r=Object.assign(Object.assign({},this._options.searchOptions),e);for(let[o,i]of this._documentIds){let c=r.boostDocument?r.boostDocument(i,"",this._storedFields.get(o)):1;n.set(o,{score:c,terms:[],match:{}})}return n}combineResults(e,n=qn){if(e.length===0)return new Map;let r=n.toLowerCase(),o=Wa[r];if(!o)throw new Error(`Invalid combination operator: ${n}`);return e.reduce(o)||new Map}toJSON(){let e=[];for(let[n,r]of this._index){let o={};for(let[i,c]of r)o[i]=Object.fromEntries(c);e.push([n,o])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:e,serializationVersion:2}}termResults(e,n,r,o,i,c,d,u,s=new Map){if(i==null)return s;for(let f of Object.keys(c)){let m=c[f],h=this._fieldIds[f],g=i.get(h);if(g==null)continue;let x=g.size,C=this._avgFieldLength[h];for(let D of g.keys()){if(!this._documentIds.has(D)){this.removeTerm(h,D,n),x-=1;continue}let R=d?d(this._documentIds.get(D),n,this._storedFields.get(D)):1;if(!R)continue;let T=g.get(D),P=this._fieldLength.get(D)[h],j=Va(T,x,this._documentCount,P,C,u),W=r*o*m*R*j,S=s.get(D);if(S){S.score+=W,Ha(S.terms,e);let O=Ln(S.match,n);O?O.push(f):S.match[n]=[f]}else s.set(D,{score:W,terms:[e],match:{[n]:[f]}})}}return s}addTerm(e,n,r){let o=this._index.fetch(r,wo),i=o.get(e);if(i==null)i=new Map,i.set(n,1),o.set(e,i);else{let c=i.get(n);i.set(n,(c||0)+1)}}removeTerm(e,n,r){if(!this._index.has(r)){this.warnDocumentChanged(n,e,r);return}let o=this._index.fetch(r,wo),i=o.get(e);i==null||i.get(n)==null?this.warnDocumentChanged(n,e,r):i.get(n)<=1?i.size<=1?o.delete(e):i.delete(n):i.set(n,i.get(n)-1),this._index.get(r).size===0&&this._index.delete(r)}warnDocumentChanged(e,n,r){for(let o of Object.keys(this._fieldIds))if(this._fieldIds[o]===n){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(e)} has changed before removal: term "${r}" was not present in field "${o}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(e){let n=this._nextId;return this._idToShortId.set(e,n),this._documentIds.set(n,e),this._documentCount+=1,this._nextId+=1,n}addFields(e){for(let n=0;n<e.length;n++)this._fieldIds[e[n]]=n}addFieldLength(e,n,r,o){let i=this._fieldLength.get(e);i==null&&this._fieldLength.set(e,i=[]),i[n]=o;let d=(this._avgFieldLength[n]||0)*r+o;this._avgFieldLength[n]=d/(r+1)}removeFieldLength(e,n,r,o){if(r===1){this._avgFieldLength[n]=0;return}let i=this._avgFieldLength[n]*r-o;this._avgFieldLength[n]=i/(r-1)}saveStoredFields(e,n){let{storeFields:r,extractField:o}=this._options;if(r==null||r.length===0)return;let i=this._storedFields.get(e);i==null&&this._storedFields.set(e,i={});for(let c of r){let d=o(n,c);d!==void 0&&(i[c]=d)}}};Vt.wildcard=Symbol("*");var Ln=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0,Wa={[qn]:(t,e)=>{for(let n of e.keys()){let r=t.get(n);if(r==null)t.set(n,e.get(n));else{let{score:o,terms:i,match:c}=e.get(n);r.score=r.score+o,r.match=Object.assign(r.match,c),yo(r.terms,i)}}return t},[ko]:(t,e)=>{let n=new Map;for(let r of e.keys()){let o=t.get(r);if(o==null)continue;let{score:i,terms:c,match:d}=e.get(r);yo(o.terms,c),n.set(r,{score:o.score+i,terms:o.terms,match:Object.assign(o.match,d)})}return n},[Ba]:(t,e)=>{for(let n of e.keys())t.delete(n);return t}},Ka={k:1.2,b:.7,d:.5},Va=(t,e,n,r,o,i)=>{let{k:c,b:d,d:u}=i;return Math.log(1+(n-e+.5)/(e+.5))*(u+t*(c+1)/(t+c*(1-d+d*r/o)))},Ja=t=>(e,n,r)=>{let o=typeof t.fuzzy=="function"?t.fuzzy(e,n,r):t.fuzzy||!1,i=typeof t.prefix=="function"?t.prefix(e,n,r):t.prefix===!0,c=typeof t.boostTerm=="function"?t.boostTerm(e,n,r):1;return{term:e,fuzzy:o,prefix:i,termBoost:c}},Dn={idField:"id",extractField:(t,e)=>t[e],tokenize:t=>t.split(Ga),processTerm:t=>t.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(t,e)=>{typeof console?.[t]=="function"&&console[t](e)},autoVacuum:!0},mo={combineWith:qn,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:Ka},Ya={combineWith:ko,prefix:(t,e,n)=>e===n.length-1},Fn={batchSize:1e3,batchWait:10},jn={minDirtFactor:.1,minDirtCount:20},On=Object.assign(Object.assign({},Fn),jn),Ha=(t,e)=>{t.includes(e)||t.push(e)},yo=(t,e)=>{for(let n of e)t.includes(n)||t.push(n)},vo=({score:t},{score:e})=>e-t,wo=()=>new Map,Ut=t=>{let e=new Map;for(let n of Object.keys(t))e.set(parseInt(n,10),t[n]);return e},Bt=t=>Wt(void 0,void 0,void 0,function*(){let e=new Map,n=0;for(let r of Object.keys(t))e.set(parseInt(r,10),t[r]),++n%1e3===0&&(yield Io(0));return e}),Io=t=>new Promise(e=>setTimeout(e,t)),Ga=/[\n\r\p{Z}\p{P}]+/u;Eo.exports=Vt});var Oe=J((bu,Lo)=>{"use strict";var H,Ao=Co();Lo.exports=H={};H.sites={};var Jt=0,To=500,Qa=t=>new Promise(e=>setTimeout(e,t)),Po=function(t,e){if(e.sitemapRequestInflight)return;e.sitemapRequestInflight=!0;let n=(u,s,f)=>$(`.neighbor[data-site="${u}"]`).find("div").removeClass(s).addClass(f),r=function(u){return u>432e5?432e5:u<6e4?6e4:u};var o=function(u,s){return s.sitemapRequestInflight=!0,wiki.site(u).get("system/sitemap.json",function(f,m){if(s.sitemapRequestInflight=!1,f){n(u,"fetch","fail"),wiki.site(u).refresh(function(){}),console.warn(`Unable to fetch sitemap for ${u}`);return}let{data:h,lastModified:g}=m;isNaN(g)&&(g=0),g>s.lastModified&&(s.sitemap=h,s.lastModified=g,$("body").trigger("new-neighbor-done",u),i(u,s));let x=r(Math.floor((Date.now()-g)/4));return s.nextCheck=Date.now()+x,console.log("delay for ",u,x/6e4),n(u,"fetch","done"),Qa(x).then(function(){return n(u,"done","fetch"),o(u,s)})})},i=(u,s)=>wiki.site(u).getIndex("system/site-index.json",function(f,m){if(f)console.log("error loading index",u,f);else try{s.siteIndex=Ao.loadJSON(m,{fields:["title","content"]}),console.log(u,"index loaded")}catch{console.log("error loading index - not a valid index",u)}});let c=function(){return n(t,"wait","fetch"),e.lastModified=0,o(t,e)},d=Date.now();d>Jt?(Jt=d+To,setTimeout(c,100)):(setTimeout(c,Jt-d),Jt+=To)};H.retryNeighbor=function(t){console.log("retrying neighbor");let e={};H.sites[t]=e,Po(t,e)};H.registerNeighbor=function(t){if(H.sites[t])return;let e={};H.sites[t]=e,Po(t,e),$("body").trigger("new-neighbor",t)};H.updateSitemap=function(t){let e,n=location.host;if(!(e=H.sites[n])||e.sitemapRequestInflight)return;let r=t.getSlug(),o=t.getDate(),i=t.getTitle(),c=t.getSynopsis(),d=t.getLinks(),u={slug:r,date:o,title:i,synopsis:c,links:d},{sitemap:s}=e,f=s.findIndex(m=>m.slug===r);f>=0?s[f]=u:s.push(u),$("body").trigger("new-neighbor-done",n)};H.deleteFromSitemap=function(t){let e,n=location.host;if(!(e=H.sites[n])||e.sitemapRequestInflight)return;let r=t.getSlug(),{sitemap:o}=e,i=o.findIndex(c=>c.slug===r);i>=0&&(o.splice(i),$("body").trigger("delete-neighbor-done",n))};H.listNeighbors=()=>Object.keys(H.sites);var Ro=t=>t.replace(/\[([^\]]*?)\][\[\(].*?[\]\)]/g," $1 ").replace(/\[{2}|\[(?:[\S]+)|\]{1,2}/g," ").replace(/\n/g," ").replace(/<style.*?<\/style>/g," ").replace(/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g," ").replace(/<(?:[^>])+>/g," ").replace(/(https?.*?)(?=\p{White_Space}|\p{Quotation_Mark}|$)/gu,function(e){let n=new URL(e);return n.hostname+n.pathname}).replace(/[\p{P}\p{Emoji}\p{Symbol}}]+/gu," ").replace(/[\p{White_Space}\n\t]+/gu," "),Xa=function(t,e,n){try{if(e.text)switch(e.type){case"paragraph":case"markdown":case"html":case"reference":case"image":case"pagefold":case"math":case"mathjax":case"code":t+=Ro(e.text);break;case"audio":case"video":case"frame":t+=Ro(e.text.split(/\r\n?|\n/).map(function(r){let o=r.split(/\p{White_Space}/u)[0];return o.startsWith("http")||o.toUpperCase()===o||o.startsWith("//")?"":r}).join(" "));break}}catch(r){throw new Error(`Error extracting text from ${n}, ${JSON.stringify(e)} ${r}, ${r.stack}`)}return t};H.updateIndex=function(t){let e;console.log(`updating ${t.getSlug()} in index`);let n=location.host;if(!(e=H.sites[n]))return;let r=t.getSlug(),o=t.getTitle(),c=t.getRawPage().story.reduce(Xa,"");return e.siteIndex.has(r)?e.siteIndex.replace({id:r,title:o,content:c}):e.siteIndex.add({id:r,title:o,content:c})};H.deleteFromIndex=function(t){let e,n=location.host;if(!(e=H.sites[n]))return;let r=t.getSlug();try{e.siteIndex.discard(r)}catch(o){o.message.includes("not in the index")||console.log(`removing ${r} from index failed`,o)}};H.search=function(t){let e,n,r=[],o={},i=function(g){return o[g]?o[g]++:o[g]=1},c=function(g,x){let C=`indexing sitemap ( ${g} )`;console.time(C),console.log("indexing sitemap:",g);let D=new Ao({fields:["title","content"]});return e.sitemap.forEach(function(R){D.add({id:R.slug,title:R.title,content:R.synopsis})}),console.timeEnd(C),D},d=Date.now();for(n of Object.keys(H.sites))e=H.sites[n],e.sitemap&&(e.siteIndex||(e.siteIndex=c(n,e)));let u=location.host;for(n of Object.keys(H.sites))if(e=H.sites[n],e.siteIndex){var s,f,m,h;i("sites");try{o.pages?o.pages+=e.sitemap.length:o.pages=e.sitemap.length}catch(g){f=g,console.info("+++ sitemap not valid for ",n),e.sitemap=[]}n===u?(h=20,s=2):(h=10,s=1);try{m=e.siteIndex.search(t,{boost:{title:h,content:s},prefix:!0,combineWith:"AND"})}catch(g){f=g,console.error("search index error",n,t,f),m=[]}m.forEach(function(g){i("finds"),r.push({page:e.sitemap.find(({slug:x})=>x===g.id),site:n,rank:g.score})})}return r.sort((g,x)=>x.rank-g.rank),o.msec=Date.now()-d,{finds:r,tally:o}};H.backLinks=function(t){let e=[];for(var n of Object.keys(H.sites)){var r=H.sites[n];r.sitemap&&r.sitemap.forEach(function(i,c){i.links&&Object.keys(i.links).length>0&&Object.keys(i.links).includes(t)&&e.push({slug:i.slug,title:i.title,site:n,itemId:i.links[t],date:i.date})})}let o={};return e.forEach(function(i){t=i.slug,o[t]=o[t]||{},o[t].title=i.title,o[t].sites=o[t].sites||[],o[t].sites.push({site:i.site,date:i.date,itemId:i.itemId})}),o}});var Me=J((xu,qo)=>{"use strict";var ve,Za=mt(),{create:Oo,apply:ec}=(kn(),q(co)),Un=(An(),q(go)),{newPage:zn}=(ye(),q(De)),Mo=Ee(),Yt=Oe();qo.exports=ve={};var Do=t=>JSON.parse(JSON.stringify(t));ve.useLocalStorage=()=>$(".login").length>0;var Fo=function(t){let e;if(e=localStorage.getItem(t))return JSON.parse(e)},jo=function({pageInformation:t,whenGotten:e,whenNotGotten:n,localContext:r}){let{slug:o,rev:i,site:c}=t,d={get(s,f){wiki.local.get(s,function(m,h){m?wiki.origin.get(s,f):(c="local",f(null,h))})}};c?r=[]:c=r.shift(),c===window.location.host&&(c="origin"),c===null&&(c="view");let u={local:wiki.local,origin:wiki.origin,recycler:wiki.recycler,view:d}[c]??wiki.site(c);u.get(`${o}.json`,function(s,f){if(!s)i&&(f=Oo(i,f)),e(zn(f,c));else if([403,404].includes(s.xhr.status)||s.xhr.status===0)r.length>0?jo({pageInformation:t,whenGotten:e,whenNotGotten:n,localContext:r}):n();else{let m=u.getDirectURL(t.slug),h=`The page handler has run into problems with this request.
<pre class=error>${JSON.stringify(t)}</pre>
The requested url.
<pre class=error>${m}</pre>
The server reported status.
<pre class=error>${s.xhr?.status}</pre>
The error message.
<pre class=error>${s.msg}</pre>
These problems are rarely solved by reporting issues.
There could be additional information reported in the browser's console.log.
More information might be accessible by fetching the page outside of wiki.
<a href="${m}" target="_blank">try-now</a>`,g=zn({title:"Trouble: Can't Get Page"},null);g.addItem({type:"html",text:h}),e(g)}})};ve.get=function({whenGotten:t,whenNotGotten:e,pageInformation:n}){if(!n.site){let r;if(r=Fo(n.slug)){n.rev&&(r=Oo(n.rev,r)),t(zn(r,"local"));return}}ve.context.length||(ve.context=["view"]),jo({pageInformation:n,whenGotten:t,whenNotGotten:e,localContext:ve.context.slice()})};ve.context=[];var No=function(t,e,n){let r;if(n.type==="create")r={title:n.item.title,story:[],journal:[]};else{let o;r=Fo(e.slug),r||(r=Mo.atKey(t.data("key")).getRawPage()),r.journal||=[],(o=n.fork)&&(r.journal=r.journal.concat({type:"fork",site:o,date:new Date().getTime()}),delete n.fork)}ec(r,n),wiki.local.put(e.slug,r,function(){Un(t.find(".journal"),n),t.addClass("local")})},tc=function(t,e,n){let r=Do(n),o=Mo.atKey(t.data("key"));(n.fork||n.type==="fork")&&(r.forkPage=Do(o.getRawPage())),wiki.origin.put(e.slug,r,function(i){if(i)n.error={type:i.type,msg:i.msg,response:i.xhr.responseText},No(t,e,n);else if(o?.apply&&o.apply(n),Yt.updateSitemap(o),Yt.updateIndex(o),Un(t.find(".journal"),n),n.type==="fork"&&wiki.local.delete(t.attr("id")),n.type!=="fork"&&n.fork&&n.item.type==="image"){let c=t.find(".item").index(t.find("#"+n.item.id).context);wiki.renderFrom(c)}})};ve.put=function(t,e){let n=function(){let i;switch(i=t.data("site")){case"origin":case"local":case"view":return null;case location.host:return null;default:return i}},r={slug:t.attr("id").split("_rev")[0],rev:t.attr("id").split("_rev")[1],site:n(),local:t.hasClass("local")},o=r.site;ve.useLocalStorage()&&(r.site||r.local||(e.site=o=location.host)),e.date=new Date().getTime(),e.site==="origin"&&delete e.site,t.removeClass("plugin"),o&&(t.find("h1").prop("title",location.host),t.find("h1 img").attr("src","/favicon.png"),t.find("h1 a").attr("href",`/view/welcome-visitors/view/${r.slug}`).attr("target",location.host),t.data("site",null),t.removeClass("remote"),Za.setUrl(),e.type!=="fork"&&(e.fork=o,Un(t.find(".journal"),{type:"fork",site:o,date:e.date}))),ve.useLocalStorage()||r.site==="local"?No(t,r,e):tc(t,r,e)};ve.delete=function(t,e,n){t.isRecycler()?wiki.recycler.delete(`${t.getSlug()}.json`,function(r){setTimeout(()=>n(r),300)}):wiki.origin.delete(`${t.getSlug()}.json`,function(r){setTimeout(function(){r||(Yt.deleteFromSitemap(t),Yt.deleteFromIndex(t)),n(r)},300)})}});var Te=J(($u,Wo)=>{"use strict";var fe;Wo.exports=fe={};var nc=t=>(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),rc=function(t){return console.log("loading url:",t),import(t)},zo=[],Ht={},Uo=fe.getScript=async function(t,e=()=>{}){if(zo.includes(t))e();else{try{await rc(t)}catch(n){console.log("getScript: Failed to load:",t,n)}zo.push(t),e()}};fe.renderFrom=async function(t){let e=$(".item").slice(t);for(let n of e.toArray()){let r=$(n);if(!r.hasClass("textEditing")){let o=r.data("item");try{r.off(),await fe.emit(r.empty(),o)}catch(i){console.error(i)}}}for(let n of e.toArray()){let r=$(n),o=r.data("item");try{let i=await fe.get(o.type);i&&i.bind&&await i.bind(r,o)}catch(i){console.error(i)}}};var oc=function(t){return function(n,r){return n.addClass("emit"),t(n,r)}},ic=function(t,e){return async function(r,o,i){r[0].consuming=[];let c=$(".item").index(r),{consumes:d}=window.plugins[t];if(d){let u=[];d.forEach(function(s){let f=$(`.item:lt(${c})`).filter(s);(!f||f.length===0)&&console.log("warn: no items in lineup that produces",s),f.each(function(m,h){let g=$(h).parents(".page").data("key"),x=$(h).attr("data-id");r[0].consuming.push(`${g}/${x}`),u.push(h.promise)})}),await Promise.all(u)}try{r.removeClass("emit"),await(r[0].promise=async function(){return e(r,o)}()),window.plugins[t].processServerEvent&&(console.log("listening for server events",r,o),forward.init(r,o,window.plugins[t].processServerEvent))}catch(u){console.log("plugin emit: unexpected error",u)}}};fe.wrap=Bo;function Bo(t,e){return e.emit=oc(e.emit),e.bind=ic(t,e.bind),e}fe.get=fe.getPlugin=async function(t,e=()=>{}){if(window.pluginSuccessor[t]&&(wiki.log("plugin successor",t,window.pluginSuccessor[t]),t=window.pluginSuccessor[t]),window.plugins[t])return e(window.plugins[t]),window.plugins[t];Ht[t]||(Ht[t]=async function(){if(window.plugins[t])return window.plugins[t];await Uo(`/plugins/${t}/${t}.js`),window.plugins[t]||await Uo(`/plugins/${t}.js`);let r=window.plugins[t];return r&&Bo(t,r),r}());let n=await Ht[t];return delete Ht[t],n||console.log("Could not find plugin ",t),e(n),n};fe.do=fe.doPlugin=async function(t,e,n=()=>{}){return t.data("item",e),await fe.renderFrom($(".item").index(t)),n()};fe.emit=async function(t,e,n=()=>{}){let r=function(i,c){t.append(`<div class="error">
  ${nc(e.text||"")}
  <button>help</button><br>
</div>`),e.text&&t.find(".error").on("dblclick",d=>wiki.textEditor(t,e)),t.find("button").on("click",function(){t[0].querySelector("dialog")||t.append(`<dialog>
  <h3>${i.toString()}</h3>
  <p> This "${e.type}" plugin won't show.</p>
  <ul>
    <li> Is it available on this server?
    <li> Is its markup correct?
    <li> Can it find necessary data?
    <li> Has network access been interrupted?
    <li> Has its code been tested?
  </ul>
  <p> Developers may open debugging tools and retry the plugin.</p>
  <button class="retry">retry</button>  <button class="close">close</button>
  <p> Learn more
    <a class="external" target="_blank" rel="nofollow"
    href="http://plugins.fed.wiki.org/about-plugins.html"
    title="http://plugins.fed.wiki.org/about-plugins.html">
      About Plugins
      <img src="/images/external-link-ltr-icon.png">
    </a>
  </p>

</dialog>`);let d=t[0].querySelector("dialog");d.addEventListener("click",function(u){u.target===d&&d.close()}),d.showModal(),$(".close").on("click",()=>d.close()),$(".retry").on("click",function(){c.emit.length>2?c.emit(t,e,()=>n()):(c.emit(t,e),n())})})};t.data("pageElement",t.parents(".page")),t.data("item",e);let o=await fe.get(e.type);try{if(o==null)throw TypeError(`Can't find plugin for '${e.type}'`);o.emit.length>2?await new Promise(function(i,c){o.emit(t,e,function(){o.bind&&o.bind(t,e),i()})}):o.emit(t,e)}catch(i){console.log("plugin error",i),r(i,o)}n()};fe.registerPlugin=(t,e)=>window.plugins[t]=e($)});var Wn={};le(Wn,{createItem:()=>cc,getItem:()=>wt,removeItem:()=>ac,replaceItem:()=>lc});function sc(t,e){setTimeout(e,t)}function wt(t){if($(t).length>0)return $(t).data("item")||$(t).data("staticItem")}function ac(t,e){Gt.default.put(t.parents(".page:first"),{type:"remove",id:e.id}),t.remove()}function cc(t,e,n){t||(t=e.parents(".page")),n.id=ue();let r=$(`<div class="item ${n.type}" data-id=""</div>`);r.data("item",n).data("pageElement",t),e?e.after(r):t.find(".story").append(r),Bn.default.do(r,n);let o=wt(e);return sc(500,()=>Gt.default.put(t,{item:n,id:n.id,type:"add",after:o?.id})),r}function lc(t,e,n){let r=$.extend({},n);t.empty().off(),t.removeClass(e).addClass(r.type);let o=t.parents(".page:first");try{t.data("pageElement",o),t.data("item",r),Bn.default.getPlugin(n.type,function(i){i.emit(t,r),i.bind(t,r)})}catch(i){t.append(`<p class='error'>${i}</p>`)}return Gt.default.put(o,{type:"edit",id:r.id,item:r})}var Gt,Bn,Qt=oe(()=>{"use strict";Gt=ie(Me()),Bn=ie(Te());We()});var Kn={};le(Kn,{open:()=>uc});function uc(t,e){let n=e;typeof e=="object"&&(n=e[0].outerHTML);let r=window.open("/dialog/#","dialog","popup,height=600,width=800");r.location.pathname!=="/dialog/"?r.addEventListener("load",o=>r.postMessage({title:t,body:n},window.origin)):r.postMessage({title:t,body:n},window.origin)}var Vn=oe(()=>{"use strict"});var Re=J((Su,Ko)=>{"use strict";var Xt,Fe,{asSlug:fc}=(ye(),q(De));Ko.exports=Fe={};Fe.resolutionContext=[];Fe.escape=Xt=t=>(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");Fe.resolveFrom=function(t,e){Fe.resolutionContext.push(t);try{e()}finally{Fe.resolutionContext.pop()}};Fe.resolveLinks=function(t,e=Xt){let n=[],r=function(d){let u=n.length;return n.push(d),`\u3016${u}\u3017`},o=(d,u)=>n[+u],i=function(d,u){let s=fc(u),f=u===u.trim()?"internal":"internal spaced";return s.length?r(`<a class="${f}" href="/${s}.html" data-page-name="${s}" title="${Fe.resolutionContext.join(" => ")}">${Xt(u)}</a>`):d},c=(d,u,s,f)=>r(`<a class="external" target="_blank" href="${u}" title="${u}" rel="nofollow">${Xt(f)} <img src="/images/external-link-ltr-icon.png"></a>`);return t=(t||"").replace(/(\d+)/g,"\u3016 $1 \u3017").replace(/\[\[([^\]]+)\]\]/gi,i).replace(/\[((http|https|ftp):.*?) (.*?)\]/gi,c),e(t).replace(/(\d+)/g,o)}});var Hn={};le(Hn,{buildPage:()=>bt,cycle:()=>Yn,emitTwins:()=>Go,newFuturePage:()=>Xo,rebuildPage:()=>Qo});function Go(t){let e,n,r,o=t.data("data");if(!o)return;let i=t.data("site")||window.location.host;["view","origin"].includes(i)&&(i=window.location.host);let c=me(o.title);if(e=Ic(o.journal)){let s,f={newer:[],same:[],older:[]};for(n in Je.default.sites){var d=Je.default.sites[n];if(n!==i&&d.sitemap!=null)for(r of d.sitemap)r.slug===c&&(s=r.date>e?f.newer:r.date<e?f.older:f.same,s.push({remoteSite:n,item:r}))}let m=[];for(var u in f){if(s=f[u],!s.length)continue;s.sort((g,x)=>g.item.date<x.item.date);let h=[];for(let g=0;g<s.length&&({remoteSite:n,item:r}=s[g],!(g>=8));g++)h.push(`<img class="remote"
src="${wiki.site(n).flag()}"
data-slug="${c}"
data-site="${n}"
title="${n}">`);m.push(`${h.join("&nbsp;")} ${u}`)}m&&t.find(".twins").html(`<p><span>${m.join(", ")}</span></p>`)}}function Qo(t,e){t.isLocal()&&e.addClass("local"),t.isRecycler()&&e.addClass("recycler"),t.isRemote()&&e.addClass("remote"),t.isPlugin()&&e.addClass("plugin");let n=Ec(t,e);return Cc(e,t),Jo.default.setUrl(),$(".editEnable").is(":visible")&&(gc(e),yc(e),vc(e)),n}function bt(t,e){let n=Ye.default.addPage(t);return e.data("key",n),e.get(0).dataset.key=n,Qo(t,e)}function Xo(t,e){let n=me(t),r=et();r.setTitle(t);let o=[];for(var i in Je.default.sites){var c=Je.default.sites[i];if(c.sitemap!=null){var d=c.sitemap.find(s=>s.slug===n);d!=null&&o.push({type:"reference",site:i,slug:n,title:d.title||n,text:d.synopsis||""})}}if(o.length>0){r.addItem({type:"future",text:"We could not find this page where it was expected.",title:t,create:e,context:je.default.context.filter(s=>!["view","origin","local"].includes(s))}),r.addItem({type:"paragraph",text:"We did find possible duplicate in the current neighborhood."});for(var u of o)r.addItem(u)}else r.addItem({type:"future",text:"We could not find this page.",title:t,create:e,context:je.default.context.filter(s=>!["view","origin","local"].includes(s))});return r}function Yn(t){var e=new Promise(function(n,r){let[o,i]=t.attr("id").split("_rev"),c=t.find(".header h1").text().trim(),d={slug:o,rev:i,site:t.data("site")},u=function(){let f=$(`a.internal[href="/${o}.html"]:last`);c=c||f.text()||o;let m=f.parents(".page").data("key"),h=Ye.default.atKey(m)?.getCreate(),g=Xo(c);return e=bt(g,t),e.then(x=>x.addClass("ghost")),n(e)},s=function(f){e=bt(f,t);for(var m of f.getNeighbors(location.host))Je.default.registerNeighbor(m);return n(e)};return je.default.get({whenGotten:s,whenNotGotten:u,pageInformation:d})});return e}var je,nt,Jo,Je,Ye,Zt,Jn,dc,Yo,Ho,hc,pc,gc,Vo,mc,yc,vc,wc,bc,xc,$c,_c,Sc,kc,Ic,Ec,Cc,en=oe(()=>{"use strict";je=ie(Me(),1),nt=ie(Te(),1),Jo=ie(mt(),1),Je=ie(Oe(),1);An();Rn();Ye=ie(Ee(),1),Zt=ie(Re(),1);We();ye();Jn=function(t){if($(t).length>0)return $(t).data("item")||$(t).data("staticItem")},dc=function(t,e,n){let r=$.extend({},n);e.data("item",r);let o=Ye.default.atKey(t.data("key"));return o.getItem(r.id)!=null?(r.alias||(r.alias=r.id),r.id=ue(),e.attr("data-id",r.id),e.data("id",r.id),e.data("item").id=r.id):r.alias!=null&&o.getItem(r.alias)==null&&(r.id=r.alias,delete r.alias,e.attr("data-id",r.id)),r},Yo=(t,e)=>t&&e&&t.get(0)===e.get(0),Ho=t=>t.children().map((e,n)=>$(n).attr("data-id")).get(),hc=function(t,e,n,r){let o,i,c=e.item,d=Jn(c),u=c.data("pageElement"),s=u.hasClass("ghost")||u.hasClass("remote");u.hasClass("ghost")||(o={page:u.data().data.title},u.data().site!=null&&(o.site=u.data().site));let f=c.parents(".page:first"),m=f.hasClass("ghost"),h=Yo(u,f),g=!h&&!t.shiftKey&&u.attr("id")===f.attr("id"),x={page:f.data().data.title};if(m||g){$(t.target).sortable("cancel");return}if(h){let T=Ho(c.parents(".story:first"));JSON.stringify(T)!==JSON.stringify(r)&&($(".shadow-copy").remove(),c.empty(),i=$(".item").index(c),n<i&&(i=n),nt.default.renderFrom(i),je.default.put(f,{id:d.id,type:"move",order:T}));return}s||t.shiftKey?$(".shadow-copy").removeClass("shadow-copy").data(c.data()).attr({"data-id":c.attr("data-id")}):je.default.put(u,{id:d.id,type:"remove",removedTo:x}),c.data("pageElement",f);let D=c.prev(".item"),R=Jn(D);d=dc(f,c,d),je.default.put(f,{id:d.id,type:"add",item:d,after:R?.id,attribution:o}),$(".shadow-copy").remove(),c.empty(),D.after(c),i=$(".item").index(c),n<i&&(i=n),nt.default.renderFrom(i)},pc=function(t,e){let n=e.item.data("pageElement"),r=n.hasClass("ghost")||n.hasClass("remote"),o=e.placeholder.parents(".page:first"),i=o.hasClass("ghost"),c=Yo(n,o),d=!c&&n.attr("id")===o.attr("id"),u=r||t.shiftKey&&!c;return i||d&&!t.shiftKey?($("body").css("cursor","no-drop"),$(".shadow-copy").hide()):u?($("body").css("cursor","copy"),$(".shadow-copy").show()):($("body").css("cursor","move"),$(".shadow-copy").hide())},gc=function(t){let e=$("body").css("cursor"),n={connectWith:".page .story",placeholder:"item-placeholder",forcePlaceholderSize:!0,delay:150},r=t.find(".story"),o=null,i=null,c=null,d=function(u){if(u.which===27)return c=!0,r.sortable("cancel")};return r.sortable(n).on("sortstart",function(u,s){let f=s.item;return o=Ho(r),i=$(".item").index(f),c=!1,$("body").on("keydown",d),f.clone().insertAfter(s.placeholder).hide().addClass("shadow-copy").css({width:"",height:"",position:"",zIndex:""}).removeAttr("data-id")}).on("sort",pc).on("sortstop",function(u,s){return $("body").css("cursor",e).off("keydown",d),c||hc(u,s,i,o),$(".shadow-copy").remove()})},Vo=function(t){let e=$(t).parents(".page:first");return Ye.default.atKey(e.data("key"))},mc=function(t,e){let n=Vo(e.draggable),r=Vo(t.target);pt.dispatchEvent(new CustomEvent("show",{detail:r.merge(n)}))},yc=function(t){let e=t.find(".journal");e.draggable({revert:!0,appendTo:".main",scroll:!1,helper:"clone"}),e.droppable({hoverClass:"ui-state-hover",drop:mc,accept:".journal"})},vc=t=>t.find(".add-factory").on("click",function(e){t.hasClass("ghost")||(e.preventDefault(),wc(t))}),wc=function(t){let e={type:"factory",id:ue()},n=$("<div />",{class:"item factory"}).data("item",e).attr("data-id",e.id);n.data("pageElement",t),t.find(".story").append(n),nt.default.do(n,e);let r=n.prev(".item"),o=Jn(r);je.default.put(t,{item:e,id:e.id,type:"add",after:o?.id})},bc=function(t){t.preventDefault(),Ye.default.debugSelfCheck(Array.from($(".page")).map(c=>$(c).data("key")));let e=$(t.target).parents(".page:first"),n=Ye.default.crumbs(e.data("key"),location.host),r=n[0],o=wiki.site(r).getDirectURL("").split("/")[0];o===""&&(o=window.location.protocol),window.open(`${o}//${n.join("/")}`,r).focus()},xc=function(t,e,n){let r;n.isRecycler()?r="recycler":r=n.getRemoteSite(location.host);let o=n.getRemoteSiteDetails(location.host);t.append(`<h1 title="${o}">
  <span>
    <a href="${n.siteLineup()}" target="${r}">
      <img src="${wiki.site(r).flag()}" height="32px" class="favicon"></a>
    ${Zt.default.escape(n.getTitle())}
  </span>
</h1>`),t.find("a").on("click",bc)},$c=function(t,e,n){e.attr("id").match(/_rev/)&&(e.addClass("ghost"),e.data("rev",n.getRevision()),t.append($(`<h2 class="revision">
  <span>
    ${n.getTimestamp()}
  </span>
</h2>`)))},_c=t=>t.append(`<div class="control-buttons">
<a href="#" class="button fork-page" title="fork this page">${Ce.fork}</a>
<a href="#" class="button add-factory" title="add paragraph">${Ce.add}</a>
</div>`),Sc=function(t,e){let n=e.getSlug(),r=Je.default.backLinks(n);if(Object.keys(r).length>0){let m=[];for(var o in r){var i=r[o];i.sites.sort((h,g)=>(h.date||0)<(g.date||0));for(var c=[],d=0;d<i.sites.length;d++){var u=i.sites[d];if(d<10){var s=i.sites[d-1]?.date===u.date?"":" ";c.unshift(s),c.unshift(`<img class="remote"
    src="${wiki.site(u.site).flag()}"
    data-slug="${o}"
    data-site="${u.site}"
    data-id="${u.itemId}"
    title="${u.site}
${wiki.util.formatElapsedTime(u.date)}">`)}else d===10&&c.unshift(" \u22EF ")}var f=Zt.default.resolveLinks(`[[${i.title}]]`);m.push(`<div style="clear: both;">
  <div style="float: left;">${f}</div>
  <div style="text-align: right;"> ${c.join("")} </div>
</div>`)}m&&t.append(`<details>
  <summary>${m.length} pages link here:</summary>
  ${m.join(`
`)}
</details>`)}},kc=function(t,e){let n=e.getRemoteSite(location.host),r=e.getSlug();t.append(`<a class="show-page-license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> .
<a class="show-page-source" href="${wiki.site(n).getDirectURL(r)}.json" title="source">JSON</a> .
<a href= "${wiki.site(n).getDirectURL(r)}.html" date-slug="${r}" target="${n}">${n} </a> .
<a href= "#" class=search>search</a>`)},Ic=function(t){let e=t||[];for(let r=e.length-1;r>=0;r--){var n=e[r];if(n.date&&n.type!=="fork")return n.date}};Ec=function(t,e){e.data("data",t.getRawPage()),t.isRemote()&&e.data("site",t.getRemoteSite()),Zt.default.resolutionContext=t.getContext(),e.empty();let n=$("<div class='paper' />");e.append(n);let[r,o,i,c,d,u,s]=["handle-parent","twins","header","story","backlinks","journal","footer"].map(function(h){if(h!=="journal"||$(".editEnable").is(":visible"))return $("<div />").addClass(h).appendTo(n)}),f=$("<div />").addClass("page-handle").appendTo(r);xc(i,e,t),$c(i,e,t);let m=t.seqItems(function(h,g){let x=$(`<div class="item ${h.type}" data-id="${h.id}">`);return c.append(x),x.data("item",h),g()});return m=m.then(function(){let h=$(".page").index(e[0]),g=$(".item").index($($(".page")[h]).find(".item"));return nt.default.renderFrom(g)}).then(()=>e),$(".editEnable").is(":visible")&&t.seqActions(function(h,g){return h.separator&&zt(u,h.separator),zt(u,h.action),g()}),Go(e),Sc(d,t),$(".editEnable").is(":visible")&&_c(u),kc(s,t),f.css({height:`${c.position().top-r.position().top-5}px`}),m},Cc=function(t,e){e.isRemote()||$("img.favicon",t).on("error",()=>nt.default.get("favicon",n=>n.create()))}});var rt={};le(rt,{createPage:()=>Xn,doInternalLink:()=>xt,showPage:()=>Zo,showResult:()=>tn});function Xn(t,e,n=null){let r;e&&e!=="view"&&(r=e),n||(n=Cn(t));let o=$(`<div class="page" id="${t}" tabindex="-1">
  <div class="paper">
    <div class="twins"> <p> </p> </div>
    <div class="header">
      <h1> <img class="favicon" src="${wiki.site(r).flag()}" height="32px"> ${n} </h1>
    </div>
  </div>
</div>`);return r&&o.data("site",r),o}function Zo(t,e,n=null){return Xn(t,e,n).appendTo(".main").each((r,o)=>Yn($(o)))}function xt(t,e,n=null){let r=me(t);e&&$(e).nextAll().remove(),e&&Gn.default.removeAllAfterKey($(e).data("key")),Zo(r,n,t),Qn.default.set($(".page").last())}function tn(t,e={}){e.$page&&$(e.$page).nextAll().remove(),e.$page&&Gn.default.removeAllAfterKey($(e.$page).data("key"));let n=t.getSlug();e.rev!=null&&(n+=`_rev${e.rev}`);let r=Xn(n).addClass("ghost");r.appendTo($(".main")),bt(t,r),Qn.default.set($(".page").last())}var Gn,Qn,Ne=oe(()=>{"use strict";Gn=ie(Ee(),1),Qn=ie(gt(),1);en();ye();pt.addEventListener("show",t=>{tn(t.detail)})});var $t={};le($t,{textEditor:()=>er});function ei(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function er(t,e,n){let r;if(n==null&&(n={}),e.type==="markdown"&&(r=0),!$(".editEnable").is(":visible"))return;let o=function(u){if(u.which===27||(u.ctrlKey||u.metaKey)&&u.which===83)return u.preventDefault(),d.trigger("focusout"),!1;if((u.ctrlKey||u.metaKey)&&u.which===73){let s;return u.preventDefault(),u.shiftKey||(s=$(u.target).parents(".page")),xt(`about ${e.type} plugin`,s),!1}if((u.ctrlKey||u.metaKey)&&u.which===77)return u.preventDefault(),t.removeClass(e.type).addClass(e.type="factory"),d.trigger("focusout"),!1;if(e.type==="paragraph"||e.type==="markdown"){let s,f=Tc(d);if(u.which===$.ui.keyCode.BACKSPACE&&f.start===0&&f.start===f.end){let m=t.prev(),h=wt(m);if(h.type!==e.type)return!1;let g=h[n.field||"text"].length;return s=d.val(),d.val(""),er(m,h,{caret:g,suffix:s}),!1}if(u.which===$.ui.keyCode.ENTER){if(!f)return!1;if(e.type==="markdown"&&r++,e.type==="paragraph"||e.type==="markdown"&&r===2){let m=t.parents(".page"),h=d.val(),g=h.substring(0,f.start).trim();return s=h.substring(f.end).trim(),g===""?(d.val(s),d.trigger("focusout"),ti(m,t.prev(),e.type,g)):(d.val(g),d.trigger("focusout"),ti(m,t,e.type,s)),!1}}else e.type==="markdown"&&(r=0)}},i=function(){t.removeClass("textEditing"),d.off();let u=t.parents(".page:first");if(e[n.field||"text"]=d.val())if(t.removeClass("output-item"),t.removeClass((s,f)=>(f.match(/\S+-source/)||[]).join(" ")),Zn.default.do(t.empty(),e),n.after){if(e[n.field||"text"]==="")return;nn.default.put(u,{type:"add",id:e.id,item:e,after:n.after})}else{if(e[n.field||"text"]===c)return;nn.default.put(u,{type:"edit",id:e.id,item:e})}else{n.after||nn.default.put(u,{type:"remove",id:e.id});let s=$(".item").index(t);t.remove(),Zn.default.renderFrom(s)}};if(!t.hasClass("textEditing")){t.addClass("textEditing"),t.off();var c=e[n.field||"text"]||"",d=$(`<textarea>${ei(c)}${ei(n.suffix||"")}</textarea>`).on("focusout",i).on("keydown",o);t.html(d),n.caret?ni(d,n.caret):n.append?(ni(d,d.val().length),d.scrollTop(d[0].scrollHeight-d.height())):d.trigger("focus")}}var Zn,nn,ti,Tc,ni,_t=oe(()=>{"use strict";Zn=ie(Te(),1);Qt();nn=ie(Me(),1);Ne();We();ti=function(t,e,n,r){let o={type:n,id:ue(),text:r},i=$(`<div class="item ${o.type}" data-id=${o.id}></div>`);i.data("item",o).data("pageElement",t),e.after(i);let c=wt(e);er(i,o,{after:c?.id})},Tc=function(t){let e=t.get(0);if(document.selection){e.focus();let n=document.selection.createRange();n.moveStart("character",-e.value.length);let r=n.text.length;return{start:r,end:r}}else return{start:e.selectionStart,end:e.selectionEnd}},ni=function(t,e){let n=t.get(0);if(n){if(n.createTextRange){let r=n.createTextRange();r.move("character",e),r.select()}else n.setSelectionRange(e,e);n.focus()}}});var oi={};le(oi,{default:()=>Rc});function Rc(t){return ri.default.getScript("/security/security.js",()=>window.plugins.security.setup(t))}var ri,ii=oe(()=>{"use strict";ri=ie(Te(),1)});var or=J((Du,ci)=>{"use strict";var U={},rn=oo();U.local=rn.local;U.origin=rn.origin;U.recycler=rn.recycler;U.site=rn.site;U.asSlug=(ye(),q(De)).asSlug;U.newPage=(ye(),q(De)).newPage;var tr=(Qt(),q(Wn));U.removeItem=tr.removeItem;U.createItem=tr.createItem;U.getItem=tr.getItem;var{open:Ac}=(Vn(),q(Kn));U.dialog=Ac;var nr=(Ne(),q(rt));U.createPage=nr.createPage;U.doInternalLink=nr.doInternalLink;U.showResult=nr.showResult;var St=Te();U.getScript=St.getScript;U.getPlugin=St.getPlugin;U.doPlugin=St.doPlugin;U.registerPlugin=St.registerPlugin;U.renderFrom=St.renderFrom;U.getData=function(t){let e;if(t){let n=$(".item").index(t);return e=$(`.item:lt(${n})`).filter(".chart,.data,.calculator").last(),e?e.data("item").data:{}}else return e=$(".chart,.data,.calculator").last(),e?e.data("item").data:{}};U.getDataNodes=function(t){let e;if(t){let n=$(".item").index(t);return e=$(`.item:lt(${n})`).filter(".chart,.data,.calculator").toArray().reverse(),$(e)}else return e=$(".chart,.data,.calculator").toArray().reverse(),$(e)};U.log=function(...t){console?.log&&console.log(...t||[])};var si=Oe();U.neighborhood=si.sites;U.neighborhoodObject=si;var ai=Me();U.pageHandler=ai;U.useLocalStorage=ai.useLocalStorage;var rr=Re();U.resolveFrom=rr.resolveFrom;U.resolveLinks=rr.resolveLinks;U.resolutionContext=rr.resolutionContext;var{textEditor:Pc}=(_t(),q($t));U.textEditor=Pc;U.util=(Be(),q(ht));U.security=(ii(),q(oi));U.createSynopsis=(Nt(),q(En));U.lineup=Ee();ci.exports=U});var ir={};le(ir,{dispatch:()=>Nc});function Lc(t){let e;return(e=t.originalEvent.dataTransfer)!=null&&e.types.includes("Files")?e.files[0]:null}function Dc(t){let e;if((e=t.originalEvent.dataTransfer)!=null&&e.types!=null&&(e.types.includes("text/uri-list")||e.types.includes("text/x-moz-url"))){let n=e.getData("URL");if(n?.length)return n}return null}function Oc(t){let e;if(e=t.match(/^https?:\/\/([a-zA-Z0-9:.-]+)(\/([a-zA-Z0-9:.-]+)\/([a-z0-9-]+(_rev\d+)?))+$/)){let n,r={};return[,n,,r.site,r.slug]=e,["view","local","origin"].includes(r.site)&&(r.site=n),r}return null}function Mc(t){return new URL(t).pathname.match(/\.(jpg|jpeg|png)$/i)?t:null}function Fc(t){return new URL(t).pathname.match(/\.(svg)$/i)?t:null}function jc(t){let e=new URL(t);try{e.searchParams.get("source")==="video"&&(e=new URL(e.searchParams.get("url")))}catch{}switch(e.hostname){case"www.youtube.com":return e.searchParams.get("list")!=null?{text:`YOUTUBE PLAYLIST ${e.searchParams.get("list")}`}:{text:`YOUTUBE ${e.searchParams.get("v")}`};case"youtu.be":return e.searchParams.get("list")!=null?{text:`YOUTUBE PLAYLIST ${e.searchParams.get("list")}`}:{text:`YOUTUBE ${e.pathname.substring(1)}`};case"vimeo.com":return{text:`VIMEO ${e.pathname.substring(1)}`};case"archive.org":return{text:`ARCHIVE ${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}`};case"tedxtalks.ted.com":return{text:`TEDX ${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}`};case"www.ted.com":return{text:`TED ${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}`};default:return null}}function Nc(t){return function(e){let n,r,o,i,c=function(d){e.preventDefault(),e.stopPropagation()};if(i=Dc(e)){let d,u,s,f;if((u=Oc(i))&&(r=t.page))return c(r(u));if((f=jc(i))&&(r=t.video))return c(r(f));if((d=Mc(i))&&(r=t.image))return c(r(d));if((s=Fc(i))&&(r=t.svg))return c(r(s));o={url:i}}if(n=Lc(e)){if(r=t.file)return c(r(n));o={file:n}}if(r=t.punt)return o||(o={dt:e.dataTransfer,types:e.dataTransfer!=null?e.dataTransfer.types:void 0}),c(r(o))}}var sr=oe(()=>{"use strict"});var ui={};le(ui,{bind:()=>qc});function qc(){$(document).on("keydown",function(t){t.keyCode===16&&zc(t)}).on("keyup",function(t){t.keyCode===16&&Uc(t)}),$(".main").on("mouseenter",".item",Wc).on("mouseleave",".item",Kc).on("mouseenter",".action",Vc).on("mouseleave",".action",Jc).on("align-item",".page",Gc).on("mouseenter",".backlinks .remote",Yc).on("mouseleave",".backlinks .remote",Hc)}function zc(t){if(Se=t.shiftKey,Se&&ae){let e;if($(".emit").addClass("highlight"),e=_e||ot){let n;$(`[data-id=${e}]`).addClass("target");let r=(n=$(this).parents(".page:first")).data("key"),o=ae.offset().top;$(".page").trigger("align-item",{key:r,id:_e,place:o})}He&&(it=He.consuming,it&&it.forEach(n=>li(n).addClass("consumed")))}}function Uc(t){Se=t.shiftKey,Se||($(".emit").removeClass("highlight"),$(".item, .action").removeClass("target"),$(".item").removeClass("consumed"))}function Bc(t){let e=$(".page").filter((n,r)=>$(r).data("key")===t);return e.length===0?null:(e.length>1&&console.log("warning: more than one page found for",key,e),e)}function li(t){let[e,n]=t.split("/"),r=Bc(e);return!r||(ae=r.find(`.item[data-id=${n}]`),ae.length===0)?null:(ae.length>1&&console.log("warning: more than one item found for",t,ae),ae)}function Wc(t){if(_e=(ae=$(this)).attr("data-id"),He=ae[0],Se){let e;$(`[data-id=${_e}]`).addClass("target");let n=(e=$(this).parents(".page:first")).data("key"),r=ae.offset().top;$(".page").trigger("align-item",{key:n,id:_e,place:r}),it=He.consuming,it&&it.forEach(o=>li(o).addClass("consumed"))}}function Kc(t){Se&&($(".item, .action").removeClass("target"),$(".item").removeClass("consumed")),_e=null,ae=null,He=null}function Vc(t){if(ot=$(this).data("id"),Se){$(`[data-id=${ot}]`).addClass("target");let e=$(this).parents(".page:first").data("key");$(".page").trigger("align-item",{key:e,id:ot})}}function Jc(t){Se&&$(`[data-id=${ot}]`).removeClass("target"),ot=null}function Yc(t){if(_e=(ae=$(this)).attr("data-id"),He=ae[0],Se){let e;$(`[data-id=${_e}]`).addClass("target");let n=(e=$(this).parents(".page:first")).data("key"),r=ae.offset().top;$(".page").trigger("align-item",{key:n,id:_e,place:r})}}function Hc(t){Se&&$(".item, .action").removeClass("target"),_e=null,He=null}function Gc(t,e){let n=$(this);if(n.data("key")===e.key||(ae=n.find(`.item[data-id=${e.id}]`),!ae.length))return;let r=e.place||n.height()/2,o=ae.offset().top+n.scrollTop()-r;n.stop().animate({scrollTop:o},"slow")}var Se,ae,_e,He,ot,it,fi=oe(()=>{"use strict";Se=!1,ae=null,_e=null,He=null,ot=null,it=null});var pi={};le(pi,{info:()=>el});function Qc(){return`<p>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
</p><p>
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
  Creative Commons Attribution-ShareAlike 4.0 International License
</a>.
</p><p>
This license applies uniformly to all contributions
by all authors. Where authors quote other sources
they do so within the terms of fair use or other
compatiable terms.
</p>`}function Xc(t,e){if(!t.journal)return"";let n={},r=[];for(var o of t.journal.slice(0).reverse())if(o.site&&(e=o.site),o.attribution?.site&&(e=o.attribution.site),o.type!=="fork"&&!n[e]){var i=wiki.site(e).getDirectURL(""),c=wiki.site(e).flag();r.push(`<a href="${i}" target="_blank"><img class="remote" title="${e}" src="${c}"> ${e}</a>`),n[e]=!0}return r.length>0?`<p>
  Author's Sites:
</p><p>
  ${r.join("<br>")}
</p>`:""}function Zc(t){return t?.provenance?`<p>
  Created From:
</p><p>
  ${di.default.resolveLinks(t.provenance)}
</p>`:""}function el(t){let e=hi.default.atKey(t.data("key")),n=e.getRawPage(),r=e.getRemoteSite(location.hostname);return Qc()+Xc(n,r)+Zc(n.journal[0])}var di,hi,gi=oe(()=>{"use strict";di=ie(Re(),1),hi=ie(Ee(),1)});var vi=J(()=>{"use strict";var qe=Me(),kt=mt(),Ge=gt(),Qe=(en(),q(Hn)),we=Ee(),tl=(sr(),q(ir)),{open:ar}=(Vn(),q(Kn)),st=(Ne(),q(rt)),{bind:nl}=(fi(),q(ui)),{info:rl}=(gi(),q(pi)),ol=Te(),{formatActionTitle:il}=(Be(),q(ht)),{asSlug:mi,newPage:cr}=(ye(),q(De)),sl=t=>t.filter(e=>e.editor).forEach(function(e){console.log(`${e.name} Plugin declares an editor, so pre-loading the plugin`),wiki.getPlugin(e.name.toLowerCase(),function(n){(!n.editor||typeof n.editor!="function")&&console.log(`${e.name} Plugin ERROR.
Cannot find \`editor\` function in plugin. Set \`"editor": false\` in factory.json or
Correct the plugin to include all three of \`{emit, bind, editor}\``)})});wiki.origin.get("system/factories.json",function(t,e){Array.isArray(e)&&(window.catalog=e,sl(e))});function yi(){$(document).on("keydown",function(s){let f=s.which==37?-1:s.which==39?1:null;if(f&&!$(s.target).is(":input")){let m=$(".page"),h=m.index($(".active"))+f;0<=h&&h<m.length&&Ge.set(m.eq(h))}(s.ctrlKey||s.metaKey)&&s.which===83&&(s.preventDefault(),$("input.search").trigger("focus"))}),$(window).on("popstate",kt.show),$(document).ajaxError(function(s,f,m){f.status===0||f.status===404||console.log("ajax error",s,f,m)});let n=s=>`${s}`.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),r=function(s){if(s?.type==="application/json"){let f=new FileReader;f.onload=function(m){let{result:h}=m.target,g=JSON.parse(h),x=cr();if(x.setTitle(`Import from ${s.name}`),g.title&&g.story&&g.journal){let C=mi(g.title),D=g;g={},g[C]=D,x.addParagraph(`Import of one page
(${n(s.size)} bytes)
from a page-json file dated ${s.lastModifiedDate}.`)}else x.addParagraph(`Import of ${Object.keys(g).length} pages
(${n(s.size)} bytes)
from an export file dated ${s.lastModifiedDate}.`);x.addItem({type:"importer",pages:g}),st.showResult(x)},f.readAsText(s)}},o=(s,f)=>qe.delete(s,f,function(m){if(!m)if(s.isRecycler())f.addClass("ghost");else{let h=Qe.newFuturePage(s.getTitle(),s.getCreate());s.become(h),f.attr("id",h.getSlug()),Qe.rebuildPage(s,f),f.addClass("ghost")}}),i=function(s,f){if(!s)return f(null);console.log("getTemplate",s),qe.get({whenGotten(m,h){f(m)},whenNotGotten(){f(null)},pageInformation:{slug:s}})},c=function(s,f){let m;return s.preventDefault(),s.shiftKey||(m=$(s.target).parents(".page")),st.doInternalLink(f,m,$(s.target).data("site")),!1},d=null;$(".main").sortable({handle:".page-handle",cursor:"grabbing"}).on("sortstart",function(s,f){if(!f.item.hasClass("page"))return;Ge.set(f.item,!0),d=$(".page").index(f.item[0])}).on("sort",function(s,f){if(!f.item.hasClass("page"))return;let m=f.item;s.pageY<0&&$(".page").length>2?m.addClass("pending-remove"):m.removeClass("pending-remove")}).on("sortstop",function(s,f){if(!f.item.hasClass("page"))return;let m=f.item,h=$(".page"),g=h.index($(".active")),x=$(".item").index(m.find(".item")[0]);if(m.hasClass("pending-remove")){if(h.length===1)return;we.removeKey(m.data("key")),m.remove(),Ge.set($(".page")[g])}else we.changePageIndex(m.data("key"),g),Ge.set($(".active")),d<g&&(g=d,x=$(".item").index($($(".page")[g]).find(".item")[0]));ol.renderFrom(x),kt.setUrl(),window.debug&&kt.debugStates()}).on("click",".show-page-license",function(s){s.preventDefault();let f=$(this).parents(".page"),m=f.find("h1").text().trim();ar(`License for ${m}`,rl(f))}).on("click",".show-page-source",function(s){s.preventDefault();let f=$(this).parents(".page"),m=we.atKey(f.data("key")).getRawPage();ar(`JSON for ${m.title}`,$("<pre/>").text(JSON.stringify(m,null,2)))}).on("click",".page",function(s){if(!$(s.target).is("a"))return Ge.set(this)}).on("click",".internal",function(s){let f=$(s.target),m=f.text()||f.data("pageName");return m=`${m}`,qe.context=$(s.target).attr("title").split(" => "),c(s,m)}).on("click","img.remote",function(s){if($(s.target).attr("src").startsWith("data:image/png")){s.preventDefault();let f=$(s.target).data("site");wiki.site(f).refresh(function(){})}else{let f=$(s.target).data("slug");return qe.context=[$(s.target).data("site")],c(s,f)}}).on("dblclick",".revision",function(s){s.preventDefault();let f=$(this).parents(".page"),m=we.atKey(f.data("key")).getRawPage(),h=m.journal.length-1,g=m.journal[h],x=JSON.stringify(g,null,2);ar(`Revision ${h}, ${g.type} action`,$("<pre/>").text(x))}).on("click",".action",function(s){s.preventDefault();let f=$(s.target),m=f.data("slug");if(f.is(".fork")&&m)return qe.context=[f.data("site")],c(s,m.split("_")[0]);{let h=$(this).parents(".page"),g=h.data("key"),x=we.atKey(g).getSlug(),C=$(this).parent().children().not(".separator").index(f);if(C<0)return;s.shiftKey||h.nextAll().remove(),s.shiftKey||we.removeAllAfterKey(g),st.createPage(`${x}_rev${C}`,h.data("site")).appendTo($(".main")).each((D,R)=>Qe.cycle($(R))),Ge.set($(".page").last())}}).on("mouseenter",".action",function(s){let f=$(s.target),{action:m}=f.data();f.attr("title",il(m))}).on("click",".fork-page",function(s){let f=$(s.target).parents(".page");if(f.find(".future").length)return;let m=we.atKey(f.data("key"));if(f.attr("id").match(/_rev0$/))o(m,f);else{let x={type:"fork"};if(f.hasClass("local")){if(qe.useLocalStorage())return;f.removeClass("local")}else m.isRecycler()?f.removeClass("recycler"):m.isRemote()&&(x.site=m.getRemoteSite());f.data("rev")!=null&&f.find(".revision").remove(),f.removeClass("ghost"),f.attr("id",f.attr("id").replace(/_rev\d+$/,"")),kt.setUrl();let C=$(".page");for(let D=0;D<C.length;D++){var h=C[D],g=$(h).data("site");$(h).data("key")!==f.data("key")&&$(h).attr("id")===f.attr("id")&&[void 0,null,"view","origin","local","recycler",location.host].includes(g)&&$(h).addClass("ghost")}qe.put(f,x)}}).on("click","button.create",s=>i($(s.target).data("slug"),function(f){let m=$(s.target).parents(".page:first");m.removeClass("ghost");let h=we.atKey(m.data("key"));h.become(f);let g=h.getRawPage();Qe.rebuildPage(h,m.empty()),qe.put(m,{type:"create",id:g.id,item:{title:g.title,story:g.story}})})).on("mouseenter mouseleave",".score",function(s){console.log("in .score..."),$(".main").trigger("thumb",$(s.target).data("thumb"))}).on("click","a.search",function(s){let f=$(s.target).parents(".page"),m=f.data("key"),h=we.atKey(m),g=cr();g.setTitle(`Search from '${h.getTitle()}'`),g.addParagraph(`Search for pages related to '${h.getTitle()}'.
Each search on this page will find pages related in a different way.
Choose the search of interest. Be patient.`),g.addParagraph("Find pages with links to this title."),g.addItem({type:"search",text:`SEARCH LINKS ${h.getSlug()}`}),g.addParagraph("Find pages with titles similar to this title."),g.addItem({type:"search",text:`SEARCH SLUGS ${h.getSlug()}`}),g.addParagraph("Find pages neighboring  this site."),g.addItem({type:"search",text:`SEARCH SITES ${h.getRemoteSite(location.host)}`}),g.addParagraph("Find pages sharing any of these items."),g.addItem({type:"search",text:`SEARCH ANY ITEMS ${h.getRawPage().story.map(x=>x.id).join(" ")}`}),s.shiftKey||f.nextAll().remove(),s.shiftKey||we.removeAllAfterKey(m),st.showResult(g)}).on("dragenter",s=>s.preventDefault()).on("dragover",s=>s.preventDefault()).on("drop",tl.dispatch({page:s=>{st.doInternalLink(s.slug,null,s.site)},file:s=>{r(s)}})),$(".provider input").on("click",function(){$("footer input:first").val($(this).attr("data-provider")),$("footer form").submit()}),$("body").on("new-neighbor-done",(s,f)=>$(".page").each((m,h)=>Qe.emitTwins($(h))));let u=s=>new Promise(function(f,m){let h=mi(s);wiki.origin.get(`${h}.json`,(g,x)=>f({title:s,slug:h,type:"reference",text:(g?g.msg:x?.story[0].text)||""}))});$("<span>&nbsp; \u2630 </span>").css({cursor:"pointer"}).appendTo("footer").on("click",function(){let s=cr();if(s.setTitle("Selected Plugin Pages"),s.addParagraph("Installed plugins offer these utility pages:"),!window.catalog)return;let f=[];for(var m of window.catalog)if(m.pages)for(var h of m.pages)f.push(h);Promise.all(f.map(u)).then(function(g){g.forEach(x=>s.addItem(x)),st.showResult(s)})}),$("<span>&nbsp; wiki <span class=editEnable>\u2714\uFE0E</span> &nbsp; </span>").css({cursor:"pointer"}).appendTo("footer").on("click",function(){$(".editEnable").toggle(),$(".page").each(function(){let s=$(this),f=we.atKey(s.data("key"));Qe.rebuildPage(f,s.empty())})}),isAuthenticated||$(".editEnable").toggle(),nl(),$(function(){kt.first();let s=$(".page").toArray();var f=function(m){if(m.length===0){Ge.set($(".page").last());return}let h=$(m.shift());Qe.cycle(h).then(()=>f(m))};f(s)})}document.readyState==="complete"||document.readyState!=="loading"?yi():document.addEventListener("DOMContentLoaded",yi)});var _i=J((Fu,$i)=>{"use strict";var al=(Ne(),q(rt)),xi=or(),wi=Oe(),{formatElapsedTime:cl,formatDelay:ll}=(Be(),q(ht)),ze=null,bi=0,ul=t=>t.hasOwnProperty("links"),fl=t=>`<span class="neighbor" data-site="${t}">
<div class="wait">
  <img src="${xi.site(t).flag()}" title="${t}">
</div>
</span>`,dl=t=>ze=t.sites,hl=function(t){let e,n,r="";r+=`${t}
`;try{n=ze[t].sitemap.length}catch(o){e=o,n=0}try{ze[t].sitemap.some(ul)?r+=`${n} pages with 2-way links
`:r+=`${n} pages
`}catch(o){e=o,console.info("+++ sitemap not valid for ",t)}return ze[t].lastModified!==0&&(r+=`Updated ${cl(ze[t].lastModified)}`,ze[t].nextCheck-Date.now()>0&&(r+=`, next refresh ${ll(ze[t].nextCheck)}`)),r},pl=function(){let t=$(".neighborhood");$("body").on("new-neighbor",(e,n)=>t.append(fl(n))).on("new-neighbor-done",function(e,n){let r;try{r=ze[n].sitemap.length}catch(o){let i=o;r=0}bi=Object.values(wi.sites).reduce(function(o,i){try{return i.sitemapRequestInflight?o:o+i.sitemap.length}catch{return o}},0),$(".searchbox .pages").text(`${bi} pages`)}).on("mouseenter",".neighbor",function(e){let n=$(e.currentTarget),{site:r}=n.data();n.find("img:first").attr("title",hl(r))}).on("click",".neighbor img",function(e){if($(e.target).parent().hasClass("fail")){$(e.target).parent().removeClass("fail").addClass("wait");let n=$(e.target).attr("title").split(`
`)[0];xi.site(n).refresh(function(){console.log("about to retry neighbor"),wi.retryNeighbor(n)})}else al.doInternalLink("welcome-visitors",null,this.title.split(`
`)[0])})};$i.exports={inject:dl,bind:pl}});function ml(t,e){let n=e.slug;e.title&&(n||=me(e.title)),n||="welcome-visitors";let r=e.site;on.default.resolveFrom(r,()=>t.append(`<p>
<img class='remote'
  src='${wiki.site(r).flag()}'
  title='${r}'
  data-site="${r}"
  data-slug="${n}"
>
${on.default.resolveLinks(`[[${e.title||n}]]`)}
\u2014
${on.default.resolveLinks(e.text)}
</p>`))}function Si(t,e){t.preventDefault();let n;return t.shiftKey||(n=$(t.target).parents(".page")),xt(e,n,$(t.target).data("site")),!1}function ki({neighborhood:t}){let e=function(r){if(r.length<2){$(".incremental-search").remove();return}if($(".incremental-search").length===0){let m=$(".searchbox").position();$("<div/>").css("left",`${m.left}px`).css("bottom",`${m.top+$(".searchbox").height()}px`).addClass("incremental-search").on("click",".internal",function(h){h.target.nodeName==="SPAN"&&(h.target=$(h.target).parent()[0]);let g=$(h.target).data("pageName");return g=`${g}`,lr.default.context=$(h.target).attr("title").split(" => "),Si(h,g)}).on("click","img.remote",function(h){if($(h.target).attr("src").startsWith("data:image/png")){h.preventDefault();let g=$(h.target).data("site");wiki.site(g).refresh(function(){})}else{let g=$(h.target).data("slug");return lr.default.context=[$(h.target).data("site")],Si(h,g)}return!1}).appendTo($(".searchbox"))}let o=t.search(r),i=r.split(" ").map(m=>m.toLowerCase()).filter(String),c=new RegExp("\\b("+r.split(" ").map(m=>m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).filter(String).join("|")+")","i"),d=m=>m.split(c).map(function(h){return i.includes(h.toLowerCase())?`{{${h}}}`:h}).join(""),u=$(".incremental-search").empty();(!o.finds||o.finds.length===0)&&$("<div/>").text("No results found").addClass("no-results").appendTo(u);let s=0,f=100;for(let m of o.finds){if(s++,s===f+1&&$("<div/>").text(`${o.finds.length-f} results omitted`).addClass("omitted-results").appendTo(u),s>f)continue;let h=$("<div/>").appendTo(u),g={id:ue(),type:"reference",site:m.site,slug:m.page.slug,title:d(m.page.title),text:d(m.page.synopsis)};ml(h,g),h.html(h.html().split(new RegExp("({{.*?}})","i")).map(x=>x.indexOf("{{")===0?`<span class='search-term'>${x.substring(2,x.length-2)}</span>`:x).join(""))}};function n(r){let o=t.search(r);if(o.finds&&o.finds.length===1){$(".incremental-search").find(".internal").trigger("click"),$(".incremental-search").remove();return}$(".incremental-search").remove();let{tally:i}=o,c={};c.title=`Search for '${r}'`,c.story=[],c.story.push({type:"paragraph",id:ue(),text:`String '${r}' found on ${i.finds||"none"} of ${i.pages||"no"} pages from ${i.sites||"no"} sites.
Text matched on ${i.title||"no"} titles, ${i.text||"no"} paragraphs, and ${i.slug||"no"} slugs.
Elapsed time ${i.msec} milliseconds.`});for(var d of o.finds)c.story.push({id:ue(),type:"reference",site:d.site,slug:d.page.slug,title:d.page.title,text:d.page.synopsis||""});c.journal=[{type:"create",item:{title:c.title,story:gl(c.story)},date:Date.now()}];let u=et(c);tn(u)}return{incrementalSearch:e,performSearch:n}}var lr,on,gl,Ii=oe(()=>{"use strict";lr=ie(Me(),1);We();Ne();ye();on=ie(Re(),1),gl=t=>JSON.parse(JSON.stringify(t))});var Ei={};le(Ei,{default:()=>ur});var ur,Ci=oe(()=>{"use strict";Ii();ur=class{static search=null;inject(t){search=ki({neighborhood:t})}bind(){return $("input.search").attr("autocomplete","off"),$("input.search").on("keydown",function(t){t.keyCode===27&&$(".incremental-search").remove()}),$("input.search").on("keypress",function(t){if(t.keyCode!==13)return;let e=$(this).val();search.performSearch(e),$(this).val("")}),$("input.search").on("focus",function(t){let e=$(this).val();search.incrementalSearch(e)}),$("input.search").on("input",function(t){let e=$(this).val();search.incrementalSearch(e)})}}});var Ai=J(()=>{"use strict";var fr=Oe(),Ti=_i(),{bind:yl,inject:vl}=(Ci(),q(Ei)),wl=mt(),bl=(Ne(),q(rt));function Ri(){vl(fr),yl(),Ti.inject(fr),Ti.bind(),window.seedNeighbors&&seedNeighbors.split(",").forEach(t=>fr.registerNeighbor(t.trim())),wl.inject(bl)}document.readyState==="complete"||document.readyState!=="loading"?Ri():document.addEventListener("DOMContentLoaded",Ri)});var Li=J((Vu,Pi)=>{"use strict";var xl=(_t(),q($t)),dr=Re(),{asSlug:$l}=(ye(),q(De)),_l=function(t,e){let n=e.slug;!n&&e.title&&(n=$l(e.title)),n||(n="welcome-visitors");let r=e.site;dr.resolveFrom(r,()=>t.append(`
<p>
<img class='remote'
  src='${wiki.site(r).flag()}'
  title='${r}'
  data-site="${r}"
  data-slug="${n}"
>
${dr.resolveLinks(`[[${e.title||n}]]`)}
\u2014
${dr.resolveLinks(e.text)}
</p>`))},Sl=(t,e)=>t.on("dblclick",()=>xl.textEditor(t,e));Pi.exports={emit:_l,bind:Sl}});var Oi=J((Ju,Di)=>{"use strict";var kl=Oe(),Il=Te(),El=Re(),Cl=Me(),sn=(_t(),q($t)),Tl=(Nt(),q(En)),Rl=(sr(),q(ir)),Al=gt(),Pl=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>"),Ll=function(t,e){t.append("<p>Double-Click to Edit<br>Drop Text or Image to Insert</p>");let n=function(){let o=t.find("p").append(`<br>Or Choose a Plugin
<center>
<table style="text-align:left;">
<tr><td><ul id=format><td><ul id=data><td><ul id=other>`);for(var i of window.catalog)if(i&&i.category){var c=i.category;["format","data"].includes(c)||(c="other"),o.find("#"+c).append(`<li><a class="menu" href="#" title="${i.title}">${i.name}</a></li>`)}o.find("a.menu").on("click",function(d){let u=d.target.text,s=u.toLowerCase();if(t.removeClass("factory").addClass(e.type=s),t.off(),d.preventDefault(),Al.set(t.parents(".page")),window.catalog.find(m=>u===m.name).editor)try{window.plugins[s].editor(t,e)}catch(m){console.log(`${u} Plugin editor failed: ${m}. Falling back to textEditor`),sn.textEditor(t,e)}else sn.textEditor(t,e)})},r=()=>t.append(`<p>${El.resolveLinks(e.prompt,Pl)}</b>`);e.prompt?r():window.catalog?n():wiki.origin.get("system/factories.json",function(o,i){window.catalog=i,n()})},Dl=function(t,e){let n=function(){t.empty().off(),t.removeClass("factory").addClass(e.type);let s=t.parents(".page:first");try{t.data("pageElement",s),t.data("item",e),Il.getPlugin(e.type,function(f){f.emit(t,e),f.bind(t,e)})}catch(f){t.append(`<p class='error'>${f}</p>`)}Cl.put(s,{type:"edit",id:e.id,item:e})},r=function(s){e.prompt=`Unexpected Item
We can't make sense of the drop.
Try something else or see [[About Factory Plugin]].`,s.userAgent=navigator.userAgent,e.punt=s,n()},o=s=>wiki.site(s.site).get(`${s.slug}.json`,function(f,m){f||(e.type="reference",e.site=s.site,e.slug=s.slug,e.title=m.title||s.slug,e.text=Tl(m),n(),e.site&&kl.registerNeighbor(e.site))}),i=function(s){e.type="video",e.text=`${s.text}
(double-click to edit caption)
`,n()},c=function(s){document.documentElement.style.cursor="wait",fetch(s).then(function(f){if(f.ok)return f.blob();throw new Error("Unable to fetch image")}).then(function(f){let m=s.split("/").pop().split("#")[0].split("?")[0],h=new FileReader;h.readAsDataURL(f),h.onload=function(g){let x=g.target.result;window.plugins.image.editor({imageDataURL:x,filename:m,imageSourceURL:s,imageCaption:`Remote image [${s} source]`,$item:t,item:e})}})},d=function(s){document.documentElement.style.cursor="wait",fetch(s).then(function(f){if(f.ok)return f;throw new Error("Unable to fetch svg")}).then(f=>f.text()).then(function(f){document.documentElement.style.cursor="default",e.type="html",e.source=s,e.text=f+`<p>[${s} Source]</p>`,n()})},u=function(s){if(s!=null){let[f,m]=s.type.split("/"),h=new FileReader;f==="image"?m.startsWith("svg")?(h.onload=function(g){let{result:x}=g.target;e.type="html",e.text=x,n()},h.readAsText(s)):(h.onload=function(g){let x=g.target.result;window.plugins.image.editor({imageDataURL:x,filename:s.name,imageCaption:"Uploaded image",$item:t,item:e})},h.readAsDataURL(s)):f==="text"?(h.onload=function(g){let{result:x}=g.target;if(m==="csv"){let C;e.type="data",e.columns=(C=Ol(x))[0],e.data=Ml(C),e.text=s.fileName}else e.type="paragraph",e.text=x;n()},h.readAsText(s)):r({name:s.name,type:s.type,size:s.size,fileName:s.fileName,lastModified:s.lastModified})}};t.on("dblclick",function(s){if($(".editEnable").is(":visible"))return s.shiftKey?sn.textEditor(t,e,{field:"prompt"}):(t.removeClass("factory").addClass(e.type="paragraph"),t.off(),sn.textEditor(t,e))}),t.on("dragenter",s=>s.preventDefault()),t.on("dragover",s=>s.preventDefault()),t.on("drop",Rl.dispatch({page:o,file:u,video:i,image:c,svg:d,punt:r}))},Ol=function(t,e){e=e||",";let n=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),r=[[]],o=null;for(;o=n.exec(t);){var i,c=o[1];c.length&&c!==e&&r.push([]),o[2]?i=o[2].replace(new RegExp('""',"g"),'"'):i=o[3],r[r.length-1].push(i)}return r},Ml=function(t){let e=t.shift(),n=function(i){let c={};return i.forEach(function(d,u){let s=e[u];d!=null&&d.match(/\S/)&&d!=="NULL"&&(c[s]=d)}),c},r=[];for(var o of t)r.push(n(o));return r};Di.exports={emit:Ll,bind:Dl}});var Fi=J((Yu,Mi)=>{"use strict";var Fl=(_t(),q($t)),jl=Re(),Nl=(Qt(),q(Wn)),ql=function(t){return t.match(/<(i|b|p|a|h\d|hr|br|li|img|div|span|table|blockquote)\b.*?>/i)?"html":"markdown"},zl=(t,e)=>{for(var n of e.text.split(/\n\n+/))n.match(/\S/)&&t.append(`<p>${jl.resolveLinks(n)}</p>`)},Ul=(t,e)=>t.on("dblclick",function(n){return n.shiftKey?(e.type=ql(e.text),Nl.replaceItem(t,"paragraph",e)):Fl.textEditor(t,e,{append:!0})});Mi.exports={emit:zl,bind:Ul}});var Ni=J((Hu,ji)=>{"use strict";var Bl=Re(),Wl=Oe(),Kl=Ee(),{rebuildPage:Vl}=(en(),q(Hn)),Jl=function(t,e){let n,r;t.append(`${e.text}`);let o=t.parents(".page:first")[0].id;if(wiki.asSlug(e.title)!==o?t.append("<p style='font-weight: 500;'>Page titles with leading/trailing spaces cannot be used to create a new page.</p>"):t.append('<br><br><button class="create">create</button> new blank page'),(r=e.create?.source?.transport)&&(t.append(`<br><button class="transport" data-slug=${e.slug}>create</button> transport from ${r}`),t.append("<p class=caption> unavailable</p>"),$.get("//localhost:4020",()=>t.find(".caption").text("ready"))),(n=Wl.sites[location.host])&&n.sitemap)for(var i of n.sitemap)i.slug.match(/-template$/)&&t.append(`<br><button class="create" data-slug=${i.slug}>create</button> from ${Bl.resolveLinks(`[[${i.title}]]`)}`);(e.context?.length>0||isSecureContext&&!location.hostname.endsWith("localhost"))&&t.append("<p>Some possible places to look for this page, if it exists.</p>");let c=!0;if(e.context?.length>0){let d=[];e.context.forEach(u=>{if(wiki.neighborhood[u].lastModified===0){let s=wiki.asSlug(e.title);d.push(`<p>
  <img class='remote'
    src='${wiki.site(u).flag()}'
    title="${u}">
  <a class='internal'
    href='http://${u}/${s}.html'
    target='_blank'>${u}</a>
</p>`)}}),d.length>0?t.append(`<div>
  <p>Try on remote wiki where it was expected to be found, opens in a new tab.</p>
  ${d.join(`
`)}
</div>`):(c=!1,t.append(`<div>
  <p>None of the expected places were unreachable.</p>
</div>`))}else c=!1;if(isSecureContext&&c&&!location.hostname.endsWith("localhost")){let d=document.URL.replace(/^https/,"http").replace(/\/\w+\/[\w-]+$/,""),u=d.length>55?d.substring(0,55)+"...":d;t.append(`<div>
  <p>Try opening lineup using http, opens in a new tab.</p>
  <p><a href="${d}" target="_blank"><img class='remote' src='/favicon.png' title='${location.host}'> ${u}</a>.</p>
</div>
<div>
  <p>
</div>`)}},Yl=(t,e)=>t.find("button.transport").on("click",function(n){t.find(".caption").text("waiting");let r={title:t.parents(".page").data("data").title,create:e.create},o={type:"POST",url:e.create.source.transport,dataType:"json",contentType:"application/json",data:JSON.stringify(r)};$.ajax(o).done(function(i){t.find(".caption").text("ready");let c=wiki.newPage(i),d=t.parents(".page"),u=Kl.atKey(d.data("key"));u.become(c,c),i=u.getRawPage(),Vl(u,d.empty())})});ji.exports={emit:Jl,bind:Yl}});var zi=J((Gu,qi)=>{"use strict";var{formatElapsedTime:Hl}=(Be(),q(ht)),Gl=(Ne(),q(rt)),{newPage:Ql}=(ye(),q(De)),Xl=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Zl=function(t,e){let n=function(r){let o=[];for(var i in r){var c=r[i],d=`<a href=${i}>${Xl(c.title)||i}</a>`;if(c.journal){var u;(u=c.journal[c.journal.length-1].date)?d+=` &nbsp; from ${Hl(u)}`:d+=` &nbsp; from revision ${c.journal.length-1}`}o.push(d)}return o.join("<br>")};return t.append(`<p style="background-color:#eee;padding:15px;">
  ${n(e.pages)}
</p>`)},eu=(t,e)=>t.find("a").on("click",function(n){let r,o=$(n.target).attr("href");n.shiftKey||(r=$(n.target).parents(".page"));let i=Ql(e.pages[o]);Gl.showResult(i,{$page:r})});qi.exports={emit:Zl,bind:eu}});var Ui=J(()=>{"use strict";var It=Te();window.plugins={reference:It.wrap("reference",Li()),factory:It.wrap("factory",Oi()),paragraph:It.wrap("paragraph",Fi()),future:It.wrap("future",Ni()),importer:It.wrap("importer",zi())};window.pluginSuccessor={federatedWiki:"reference",mathjax:"math"}});var tu=J(()=>{window.name=window.location.host;window.wiki=or();vi();Ai();Ui()});tu();})();
/*! Bundled license information:

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)
*/
//# sourceMappingURL=client.cjs.map
